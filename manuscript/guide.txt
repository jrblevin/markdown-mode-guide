---
title: Guide to Markdown Mode for Emacs
author: Jason R. Blevins
date: December 2017
tags: Emacs, markdown, markdown-mode, writing, plain text
---

{mainmatter}

# Introduction {#intro}

![Markdown Mode Screenshot](images/markdown-mode-2.3.png)

This _Guide_ describes how to install, use, and customize
[Markdown Mode](https://jblevins.org/projects/markdown-mode/), a major mode for editing Markdown-formatted text
files in [Emacs](https://www.gnu.org/software/emacs/).  It is not intended to be a replacement for the
online manual, but rather to supplement and extend the manual for
users who want to learn to use Markdown Mode more effectively.

The goal of this book is to make writing and publishing with Markdown
in Emacs more enjoyable and efficient.  The hope is that through
examples and detailed descriptions of the various commands and
customizable variables, users can learn more about Emacs itself and
also improve their Markdown writing workflows.

This book covers the usual basic information about obtaining,
installing and configuring Markdown Mode, but it also addresses
advanced usage such as subtree and structure editing, defun and page
movement, marking, narrowing, region manipulation, etc.  It goes
beyond the basic documentation by also discussing interaction with
other packages and systems such as Flyspell mode, CriticMarkup mode,
Pandoc mode, Deft, HTML as Markdown mode, and MathJax.  Finally, it
also contains tips and tricks for custom configuration options such as
custom CSS stylesheets, using pre- and post-processors, customizing
faces, keeping notes in a local wiki, etc.

This guide is based on **Markdown Mode version 2.3**.
Markdown Mode and this guide were written by [Jason Blevins](https://jblevins.org/).
Markdown Mode is free software, licensed under the
GNU General Public License (GPL) version 3 or later,
and it may be freely obtained from the [Markdown Mode homepage](https://jblevins.org/projects/markdown-mode/).

## Quick Reference

If you are a seasoned Markdown Mode user, here is a quick reference
table including new version 2.3 features:

| Action                                          | Keybinding        |
|-------------------------------------------------|-------------------|
| **Headings**                                    |                   |
| Insert heading depending on context             | `C-c C-s h`       |
| Insert heading, prefer setext                   | `C-c C-s H`       |
| Insert atx heading of level # = 1, 2, … 6       | `C-c C-s #`       |
| Insert setext heading of level 1                | `C-c C-s !`       |
| Insert setext heading of level 2                | `C-c C-s @`       |
| **Inline Elements**                             |                   |
| Bold                                            | `C-c C-s b`       |
| Italics                                         | `C-c C-s i`       |
| Inline code                                     | `C-c C-s c`       |
| `kbd` tag                                       | `C-c C-s k`       |
| Wiki link                                       | `C-c C-s w`       |
| **Block Elements**                              |                   |
| Preformatted/code block                         | `C-c C-s p`       |
| Preformatted/code block (region)                | `C-c C-s P`       |
| Blockquote                                      | `C-c C-s q`       |
| Blockquote (region)                             | `C-c C-s Q`       |
| GFM code block                                  | `C-c C-s C`       |
| Edit code block in indirect buffer              | `C-c '`           |
| **Links and Images**                            |                   |
| Insert or edit link (inline, reference, or URL) | `C-c C-l`         |
| Insert or edit image (inline or reference)      | `C-c C-i`         |
| Follow link at point                            | `C-c C-o`         |
| Jump between reference link and definition      | `C-c C-d`         |
| Move to next link                               | `M-n`             |
| Move to previous link                           | `M-p`             |
| **Footnotes**                                   |                   |
| Insert footnote                                 | `C-c C-s f`       |
| Jump between footnote and definition            | `C-c C-d`         |
| **List Items & List Editing**                   |                   |
| Insert new list item (same level)               | `M-RET`           |
| Insert new list item (same level)               | `C-c C-j`         |
| Insert new list item (parent level)             | `C-u C-c C-j`     |
| Insert new list item (child level)              | `C-u C-u C-c C-j` |
| Move list item up                               | `C-c <up>`        |
| Move list item down                             | `C-c <down>`      |
| Outdent/promote list item                       | `C-c <left>`      |
| Indent/demote list item                         | `C-c <right>`     |
| Insert GFM checkbox                             | `C-c C-s [`       |
| Toggle GFM checkbox                             | `C-c C-x C-x`     |
| **Horizontal Rules**                            |                   |
| Insert default horizontal rule string           | `C-c C-s -`       |
| **Killing and Yanking**                         |                   |
| Kill element and keep text in kill ring         | `C-c C-k`         |
| Yank text back into buffer                      | `C-y`             |
| **Movement by Paragraph**                       |                   |
| Backward paragraph                              | `M-{`             |
| Forward paragraph                               | `M-}`             |
| Mark paragraph                                  | `M-h`             |
| **Movement by Block**                           |                   |
| Backward block                                  | `C-M-{`           |
| Forward block                                   | `C-M-}`           |
| Mark block                                      | `C-c M-h`         |
| Narrow to block                                 | `C-x n b`         |
| Widen                                           | `C-x n w`         |
| **Movement by Section (Defun)**                 |                   |
| Beginning of section                            | `C-M-a`           |
| End of section                                  | `C-M-e`           |
| Mark section                                    | `C-M-h`           |
| Mark subtree                                    | `C-c C-M-h`       |
| Narrow to section                               | `C-x n d`         |
| Narrow to subtree                               | `C-x n s`         |
| Widen                                           | `C-x n w`         |
| **Outline & List Movement**                     |                   |
| Next heading or list item                       | `C-c C-n`         |
| Previous heading or list item                   | `C-c C-p`         |
| Next heading or list item (same level)          | `C-c C-f`         |
| Previous heading or list item (same level)      | `C-c C-b`         |
| Move up to parent heading or list item          | `C-c C-u`         |
| **Outline Visibility Cycling**                  |                   |
| Cycle visibility globally                       | `S-TAB`           |
| Cycle visibility of heading at point            | `TAB`             |
| **Outline Subtree Editing**                     |                   |
| Move subtree up                                 | `C-c <up>`        |
| Move subtree down                               | `C-c <down>`      |
| Promote subtree                                 | `C-c <left>`      |
| Demote subtree                                  | `C-c <right>`     |
| **Table Editing**                               |                   |
| Jump to next table cell                         | `TAB`             |
| Jump to previous table cell                     | `S-TAB`           |
| Move to next cell in same column                | `RET`             |
| Move current row up                             | `C-c <up>`        |
| Move current row down                           | `C-c <down>`      |
| Move current column left                        | `C-c <left>`      |
| Move current column right                       | `C-c <right>`     |
| Kill the current row                            | `C-c S-<up>`      |
| Insert new row above                            | `C-c S-<down>`    |
| Kill the current column                         | `C-c S-<left>`    |
| Insert new column to left                       | `C-c S-<right>`   |
| Realign table                                   | `C-c C-d`         |
| Sort table lines                                | `C-c C-c ^`       |
| Convert region to table                         | `C-c C-c |`       |
| Transpose table                                 | `C-c C-c t`       |
| **Region Editing**                              |                   |
| Indent region                                   | `C-c >`           |
| Exdent region                                   | `C-c <`           |
| **Promotion and Demotion**                      |                   |
| Promote element at point                        | `C-c -`           |
| Demote element at point                         | `C-c =`           |
| **Markup Completion**                           |                   |
| Complete markup at point or in region           | `C-c C-]`         |
| Complete markup in buffer                       | `C-c C-c ]`       |
| **Markdown & Utility Commands**                 |                   |
| Run Markdown, output to temporary buffer        | `C-c C-c m`       |
| Run Markdown, export to file                    | `C-c C-c e`       |
| Run Markdown, preview in browser                | `C-c C-c p`       |
| Run Markdown, export, and preview               | `C-c C-c v`       |
| Run Markdown, save to kill ring                 | `C-c C-c w`       |
| Toggle live preview mode                        | `C-c C-c l`       |
| Open external previewer                         | `C-c C-c o`       |
| Check references in buffer                      | `C-c C-c c`       |
| Renumber ordered lists in buffer                | `C-c C-c n`       |
| **Toggles and Settings**                        |                   |
| Toggle markup hiding                            | `C-c C-x C-m`     |
| Toggle URL hiding                               | `C-c C-x C-l`     |
| Toggle native code block font lock              | `C-c C-x C-f`     |
| Toggle inline images                            | `C-c C-x C-i`     |
| Toggle LaTeX math support                       | `C-c C-x C-e`     |
| Toggle GFM checkbox                             | `C-c C-x C-x`     |

## Markdown

[Markdown](http://daringfireball.net/projects/markdown/) is a lightweight markup language, originally created by
[John Gruber](https://daringfireball.net) in late 2003 and released in 2004.  Markdown aims to be
simultaneously easy to write and easy to read.  It takes many cues from
previous, similar attempts such as [atx](http://www.aaronsw.com/2002/atx/), by [Aaron Swartz](http://www.aaronsw.com),[^aaronsw]
[setext](http://docutils.sourceforge.net/mirror/setext.html), by Ian Feldman, and [Textile](https://txstyle.org), by Dean Allen, as well
as from existing conventions for marking up plain text email.

"Markdown" is also used to refer to the original Markdown processor,
also written by John Gruber, which is a Perl script that converts plain
Markdown-formatted text input to HTML output.  It is distributed
under a BSD-style license and is included with, or available as a
plugin for, several content management systems.  In the remainder I
will refer to the processor by its filename, Markdown.pl, to
distinguish between the Markdown syntax and the Perl script.  After
the original Perl implementation, Markdown processors have been
implemented by others in a variety of programming languages.
Some examples are, in no particular order, PHP Markdown Extra, Python
Markdown, MultiMarkdown (Perl and C), Pandoc (Haskell), Discount (C),
Maruku (Ruby), RedCarpet (Ruby), Kramdown (Ruby), Showdown
(JavaScript), and CommonMark (C and JavaScript).

[^aaronsw]: John Gruber described Aaron Swartz as his "muse" while developing Markdown, due to his early enthusiasm for and feedback on the project.  Aaron Swartz also wrote [html2text](http://www.aaronsw.com/2002/html2text/), a popular HTML to Markdown converter written in Python.

### Markdown Syntax Reference

For reference, below is a plain-text summary of Markdown's syntax.
Additional details about each type of element are explained in the
course of describing the Markdown Mode editing commands.  See the
original [Markdown syntax page](http://daringfireball.net/projects/markdown/syntax) for complete details.

<<(examples/markdown.md)

Characters can be backslash-escaped in Markdown.  That is, characters
which are ordinarily interpreted by Markdown as formatting commands
will instead be interpreted literally if preceded by a backslash.  For
example, when you need to type a literal asterisk or underscore:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This is *italic*, but this \*is not\*.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Markdown.pl also does not transform any text within raw block-level
HTML elements (although some other processors do).  Thus it is
possible to include sections of HTML within a Markdown source
document by wrapping them in block-level HTML tags.  However, with a
small number of exceptions (e.g., comments and `kbd` tags) Markdown
Mode does not explicitly support inline HTML.

### Additional Information

For additional information on Markdown syntax, you can refer to the
following links:

*   [Markdown Syntax](http://daringfireball.net/projects/markdown/syntax) - Original syntax description by John Gruber
*   [Markdown Dingus](http://daringfireball.net/projects/markdown/dingus) - Online converter using Markdown.pl
*   [Babelmark 2](https://johnmacfarlane.net/babelmark2/) - Online converter comparing many Markdown processors
*   [Wikipedia article](http://en.wikipedia.org/wiki/Markdown) - Background information on Markdown with syntax examples
*   [Mastering Markdown](https://guides.github.com/features/mastering-markdown/) - Guide to Markdown and extensions by GitHub
*   [Pandoc User's Guide](http://pandoc.org/MANUAL.html) - Markdown and Pandoc extensions
*   [PHP Markdown Reference](https://michelf.ca/projects/php-markdown/reference/) - Markdown and PHP Markdown Extra extensions
*   [Write better Markdown](http://brettterpstra.com/2015/08/24/write-better-markdown/) - Style guide by Brett Terpstra

## History

Markdown Mode was originally written and is still maintained
by [Jason Blevins](https://jblevins.org/).  The initial release, version 1.1, was created
on May 24, 2007.  As of this writing, the latest stable version of
Markdown Mode is version 2.3, released on August 31, 2017.  For a
complete list of changes, see the [version 2.3 release notes](https://jblevins.org/projects/markdown-mode/rev-2-3)
or those for previous versions:

  * 2017-05-26: [Version 2.2](https://jblevins.org/projects/markdown-mode/rev-2-2)
  * 2016-01-09: [Version 2.1](https://jblevins.org/projects/markdown-mode/rev-2-1)
  * 2013-03-24: [Version 2.0](https://jblevins.org/projects/markdown-mode/rev-2-0)
  * 2013-01-25: [Version 1.9](https://jblevins.org/projects/markdown-mode/rev-1-9)
  * 2011-08-15: [Version 1.8.1](https://jblevins.org/projects/markdown-mode/rev-1-8-1)
  * 2011-08-12: [Version 1.8](https://jblevins.org/projects/markdown-mode/rev-1-8)
  * 2009-10-01: [Version 1.7](https://jblevins.org/projects/markdown-mode/rev-1-7)
  * 2008-06-04: [Version 1.6](https://jblevins.org/projects/markdown-mode/rev-1-6)
  * 2007-10-11: [Version 1.5](https://jblevins.org/projects/markdown-mode/rev-1-5)
  * 2007-06-29: [Version 1.4](https://jblevins.org/projects/markdown-mode/rev-1-4)
  * 2007-06-05: [Version 1.3](https://jblevins.org/projects/markdown-mode/rev-1-3)
  * 2007-05-25: [Version 1.2](https://jblevins.org/projects/markdown-mode/rev-1-2)
  * 2007-05-24: [Version 1.1](https://jblevins.org/projects/markdown-mode/rev-1-1)

I> Historically, version numbering began at 1.1 because the source code
I> was originally stored in RCS (Revision Control System), which numbers
I> revisions starting at 1.1 by default.  After version 1.5, the source
I> was moved to Git, where it still resides today.  See the chapter
I> on [Markdown Mode Development](#devel) for instructions on how to obtain
I> the source code.

## Acknowledgments

Markdown Mode has benefited greatly from the efforts of the many
volunteers who have sent patches, test cases, bug reports,
suggestions, helped with packaging, etc.  Thank you for your
contributions!  Markdown Mode is much more robust and includes many
additional features as a result of your efforts.  Below is a partial
list of contributors (in alphabetical order).  See the
[GitHub contributors graph](https://github.com/jrblevin/markdown-mode/graphs/contributors) and the commit log for more details.

<!--
git shortlog -s -n | awk '{ $1=""; print $0 }'
M-x sort-regexp-fields RET \(.*\) \(.*?\)$ RET 2 RET
-->

> Masayuki Ataka, Hilko Bengen, Jonas Bernoulli, Greg Bognar, Roger
> Bolsius, Daniel Brotsky, Cyril Brulebois, Daniel Burrows, Donald
> Ephraim Curtis, Julien Danjou, Werner Dittmann, Jeremiah Dodds,
> Carsten Dominik, Michael Dwyer, Dmitry Dzhus, Peter Eisentraut,
> Conal Elliott, Bryan Fink, Gunnar Franke, Samuel Freilich, Shigeru
> Fukaya, Peter S. Galbraith, Alexis Gallagher, Francois Gannaz, David
> Glasser, Matus Goljer, Kévin Le Gouguec, Marijn Haverbeke, Isaac
> Hodes, Philippe Ivaldi, Zhenlei Jia, Peter Jones, Antonis Kanouras,
> Marcin Kasperski, Keshav Kini, Dave Kleinschmidt, Vasily Korytov,
> Joost Kremers, Bryan Kyle, Kévin Le Gouguec, Chris Lott, Christopher
> J. Madsen, Tom May, Danny McClanahan, Matt McClure, Howard Melman,
> Eric Merritt, Nelson Minar, Stefan Monnier, Makoto Motohashi, Jon
> Mountjoy, Akinori Musha, Pierre Neidhardt, Spanti Nicola, Theresa
> O'Connor, George Ogata, Jose A. Ortega Ruiz, Max Penet, Nicolas
> Petton, Jorge Israel Peña, Scott Pfister, Kevin Porter, Steve
> Purcell, Paul W. Rankin, Alec Resnick, Christophe Rhodes, Dmitry
> Safronov, Enrico Scholz, Dale Sedivec, Ankit Solanki, Tyler Smith,
> Michael Sperber, Mike Sperber, Vitalie Spinu, Philipp Stephani,
> Moogen Tian, Vegard Vesterheim, Tim Visher, Ben Voui, Sebastian
> Wiesner, Peter Williams, Tianxiang Xiong, Ian Yang, Syohei Yoshida,
> and Google, Inc.

------------------------------------------------------------------------------

# Installation & Configuration {#install}

There are many ways to load packages in Emacs, and the following three
are covered in this section: installation using the built-in Emacs
package manager (recommended), installation using a system-wide
package manager, and manual installation.

Markdown Mode is compatible with Emacs 24.4 and later, and it has few
dependencies.  To preview files and export to HTML, you will need to
install and configure a Markdown processor (e.g., Markdown.pl).
Also, to enable editing of code blocks in indirect buffers
using `C-c '` (`markdown-edit-code-block`), you will need to install
the [`edit-indirect`](https://github.com/Fanael/edit-indirect/) package.

I> This chapter covers installing the stable version of Markdown
I> Mode, but installing the development version is similar.  If you would
I> like to test the development version see the [Markdown Mode Development](#devel)
I> chapter at the end.

## Installation Methods

### Emacs Package Manager

The recommended way to install Markdown Mode is to use the built-in
Emacs package manager, `package.el`, which has been included in Emacs
since version 23.  Markdown Mode can be installed via the `markdown-mode`
package in the [MELPA Stable repository](https://stable.melpa.org/#/markdown-mode).[^MELPA]

First, you will need to configure the package manager to use the MELPA
Stable repository by adding the following to your `.emacs`, `init.el`,
or equivalent init file:

``` emacs-lisp
(require 'package)
(add-to-list 'package-archives
    '("melpa-stable" . "https://stable.melpa.org/packages/"))
(package-initialize)
```

Then, after restarting Emacs or evaluating the above statements, issue
the following command: `M-x package-install RET markdown-mode`.
When installing this way, the major modes `markdown-mode` and
`gfm-mode` will be autoloaded and `markdown-mode` will be invoked
automatically for file names ending in either `.md` or `.markdown`.[^extensions]

Alternatively, if you manage loading packages with [use-package](https://github.com/jwiegley/use-package)
(a practice I highly recommend) then you can
automatically install and configure `markdown-mode` by adding a
declaration such as the one below to your init file (this is an example,
so adjust the settings as needed):

``` emacs-lisp
(use-package markdown-mode
  :ensure t
  :commands (markdown-mode gfm-mode)
  :mode (("README\\.md\\'" . gfm-mode))
  :init (setq markdown-command "/usr/local/bin/multimarkdown"))
```

[^MELPA]: MELPA is Milkypostman's Emacs Lisp Package Archive at <http://melpa.org/>.

[^extensions]: See the tip on [Using Markdown Mode with Other File Extensions](#file-extensions) for instructions on how to configure Emacs to use `markdown-mode` for file extensions other than `.md` and `.markdown`.

### OS Package Manager

Markdown Mode is also available in various package managers on several
operating systems.  You should confirm that the package you install
contains the latest stable version (and please notify the package
maintainer if not).  These packages also typically do not byte compile
the source files or configure them to load automatically, so you may
still need to follow the [Manual Installation](#manual) instructions in the
next section.

**MacOS:** MacOS users who use Homebrew can install the
[markdown-mode formula](https://github.com/dunn/homebrew-emacs/blob/master/Formula/markdown-mode.rb), which in turn obtains the latest
stable version of Markdown Mode from GitHub.

``` text
brew tap dunn/emacs
brew install dunn/emacs/markdown-mode
```

This will install files in
`/usr/local/share/emacs/site-lisp/markdown-mode`.  Depending on where
you obtained Emacs, this directory may or may not be in your
`load-path`, so you may need to add it as described in the
[Manual Installation](#manual) section that follows.

W> If you are a MacPorts user, unfortunately there does not seem to be
W> an up-to-date port.  The existing [markdown-mode.el](https://trac.macports.org/browser/trunk/dports/editors/markdown-mode.el/Portfile) port
W> currently points to a Git revision from 2014.  There is also a
W> [pending](http://trac.macports.org/ticket/35716) ticket for a new port, but there has been no activity.
W> Rather than installing from MacPorts, I recommend using the Emacs
W> package manager as described above.

**Debian and Ubuntu Linux:** On Debian-based distributions, Markdown
Mode can be installed via the [elpa-markdown-mode](https://packages.debian.org/sid/lisp/elpa-markdown-mode) package.

``` text
sudo apt-get install elpa-markdown-mode
```

**FreeBSD:** FreeBSD users can install
the [textproc/markdown-mode.el](http://svnweb.freebsd.org/ports/head/textproc/markdown-mode.el) port, but note that the
installed files are not byte compiled.  Users who install this port
will also need to edit their init files following the Manual
Installation instructions in the next section to load Markdown Mode.

**NetBSD:** Markdown Mode is available in pkgsrc
as [textproc/markdown-mode](http://pkgsrc.se/textproc/markdown-mode), but (as of May 8, 2017) it installs and
byte-compiles an outdated version of Markdown Mode.  If you use this
package, you will also need to edit your init file following the Manual
Installation instructions below, to load Markdown Mode.  Rather than
installing this package, use the Emacs package manager as described
above.

``` text
pkg_add textproc/markdown-mode
```

### Manual Installation {#manual}

Alternatively, you can manually download and install Markdown Mode.
First, download the [latest stable version](https://jblevins.org/projects/markdown-mode/markdown-mode.el)[^stable] and save
the file where Emacs can find it (i.e., a directory in your
`load-path`).  You can then configure `markdown-mode` and `gfm-mode`
to load automatically by adding the following to your init file:

``` emacs-lisp
(autoload 'markdown-mode "markdown-mode"
  "Major mode for editing Markdown files" t)
(add-to-list 'auto-mode-alist '("\\.markdown\\'" . markdown-mode))
(add-to-list 'auto-mode-alist '("\\.md\\'" . markdown-mode))

(autoload 'gfm-mode "markdown-mode"
   "Major mode for GitHub Flavored Markdown files" t)
(add-to-list 'auto-mode-alist '("README\\.md\\'" . gfm-mode))
```

[^stable]: The latest stable version is available at <https://jblevins.org/projects/markdown-mode/markdown-mode.el>.

## Configuring Markdown  {#configuring-markdown}

Although strictly speaking no configuration is _necessary_, there are
a few settings that most users will want to customize.  The most
important of these is the `markdown-command` variable, which tells
Markdown Mode where to find an external program on your system for
converting Markdown to HTML.  You should customize this variable so
that Markdown Mode uses your Markdown processor of choice.

`markdown-command`

:   String or function, default: `"markdown"`.

    The command or function used to convert Markdown to HTML, along
    with any necessary command-line options.  The default is to look
    for an executable named `markdown` in the Emacs `exec-path`.
    When this variable is a function, it will be called with three
    arguments: the beginning of the region, the end of the region, and
    a buffer to write the output to.

If you are using the customize interface, you simply need to type the
path to your Markdown script or binary in the "Markdown Command" field
in the customize interface (e.g., `/usr/local/bin/multimarkdown`).  If
you know the name of the executable, say `multimarkdown`, but you are
not sure where it is located, and you are using macOS or Linux, you
can find it by typing `which multimarkdown` at the command line.

To set this variable in your init file, add a line such as the
following:

``` emacs-lisp
(setq markdown-command "/usr/local/bin/multimarkdown")
```

### Configuring Markdown on macOS with Homebrew

If you use Homebrew, then you can install Markdown.pl, Pandoc, or
MultiMarkdown by issuing one of the following commands:

``` text
brew install markdown
brew install pandoc
brew install multimarkdown
```

Then, in Emacs, type `M-x customize-mode RET markdown-mode` and set
"Markdown Command" to the path of the executable you just installed:
`/usr/local/bin/markdown`, `/usr/local/bin/pandoc`, or
`/usr/local/bin/multimarkdown`.

### Configuring Markdown on Windows

On Windows, you will need to use the full path including the drive
letter.  For example, if you installed Pandoc in `C:\Utils\Console`,
then you would set `markdown-command` like this:

``` emacs-lisp
(setq markdown-command "c:/Utils/Console/pandoc.exe")
```

If you need to run Markdown as a script, with an interpreter, then
you will need to add that as well.  For example, to use Markdown.pl with
Perl (both need to be installed), something like this should suffice:

``` emacs-lisp
(setq markdown-command "c:/path/to/perl.exe c:/path/to/Markdown.pl")
```

### Passing Command Line Options to Markdown

You can also customize this variable to pass any necessary
command line options to your Markdown processor.  For example, to ask
MultiMarkdown to enable smart typography and footnotes, you can define
`markdown-command` as follows:

``` emacs-lisp
(setq markdown-command "/usr/local/bin/multimarkdown --smart --notes")
```

If you use Pandoc, you may want to configure it as follows:

``` emacs-lisp
(setq markdown-command
      (concat
       "/usr/local/bin/pandoc"
       " --from=markdown --to=html"
       " --standalone --mathjax --highlight-style=pygments"))
```

The command-line arguments ask Pandoc to convert Markdown to HTML, to
produce a standalone HTML document rather than a snippet, to enable
MathJax (to render LaTeX as MathML), and to use Pygments for syntax
highlighting of code blocks.

### Passing a File Name to Markdown

By default, Markdown Mode assumes that your Markdown processor accepts
input via the standard input, or `stdin`.  That is, it assumes that if
you were using it from the command line, you could _pipe_ input to it
like so:

``` text
cat document.md | markdown
```

If your Markdown processor needs to be passed a file name, you will need
to set another variable: `markdown-command-needs-filename`.
When this variable is `nil` (the default), Markdown Mode will pass the
Markdown content to `markdown-command` using `stdin`.  When set to
`t`, Markdown Mode will pass the name of the file as the final command
line argument to `markdown-command`.  Note that in the latter case,
you will only be able to run `markdown-command` from buffers which are
visiting a file.

`markdown-command-needs-filename`

:   Boolean, default: `nil`.

    Set to `t` if the program specified as `markdown-command`
    needs the filename to be specified as a command line argument,
    rather than reading the content from the standard input (`stdin`).
    When `markdown-command` is a function, the value of this variable
    is ignored.

### Markdown Command and `exec-path`

You can set `markdown-command` to be the full path to the executable,
as in previous examples, but a better solution is to set your
`exec-path` properly so that Emacs can find it without the full path.
You can check this in two ways.  First, to see the value of
`exec-path`, issue `M-x describe-variable RET exec-path`.  If you see
the directory containing your Markdown executable in the path, then
the name of the program by itself should suffice without the path
(e.g., `multimarkdown`).

Second, you can also use the `executable-find` command to see if Emacs
can find your Markdown processor.  This isn't an interactive command,
but you can run it using `eval-expression` via `M-:`.  For example, to
check whether Emacs can find an executable named `pandoc`, you can
issue `M-: (executable-find "pandoc")`.  The return value will be
displayed in the minibuffer.  If you see the path to `pandoc`, then
Emacs can find it.  If you see `nil`, then `pandoc` could not be found
in your `exec-path`.

E> If you attempt to preview or export your buffer and you see an error
E> regarding the `markdown` command (which is the default value of the
E> `markdown-command` variable), then most likely you need to check
E> your `markdown-command` setting or install a Markdown processor (or
E> both).  Below are some common error messages that indicate that
E> either the `markdown` binary cannot be found or `markdown-command`
E> should be customized to your system:
E>
E> {lang="text"}
E> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
E> /bin/bash: markdown: command not found
E>
E> zsh:1: command not found: markdown
E>
E> 'markdown' is not recognized as an internal or external
E>     command, operable program or batch file.
E> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

T> If you are having trouble setting your `exec-path`, a simple way to
T> configure it is to install the
T> [`exec-path-from-shell`](https://github.com/purcell/exec-path-from-shell)
T> package.  Its purpose is to ensure that environment variables in
T> Emacs are the same as in your shell.  This allows Emacs to find any
T> commands you can also execute from the command line without
T> specifying the full path.


## Customization

{width=70%}
![Markdown Customize Group](images/customize-group-markdown.png)

When in Markdown Mode, the `M-x customize-mode` command provides an
interface to all of the available customizations.  If you are
using a different mode, then you will need to be more specific: `M-x
customize-mode RET markdown-mode`.  Alternatively, you can customize
variables using `M-x customize-group RET markdown` (i.e., by
customizing the _group_ rather than the _mode_).

T> If you use this built-in customize interface, be sure to save your
T> changes before closing the buffer by clicking the "Apply and Save"
T> button.

{width=70%}
![Markdown Faces Customize Group](images/customize-group-markdown-faces.png)

Additionally, the faces used for font lock (syntax highlighting)
can be modified to your liking---the font family, color,
size, and so on---by issuing `M-x customize-group RET
markdown-faces` or by using the "Markdown Faces" link at the
bottom of the mode customization screen.

------------------------------------------------------------------------------

# Movement & Editing {#editing}

This section describes the movement, insertion, and editing commands
provided by Markdown Mode.  Commands pertaining to block elements are
described first: headings, paragraphs, blockquotes, lists, code blocks,
and horizontal rules.  Then, commands for editing span elements are
described: emphasis, code, links, images, and comments.  Finally,
miscellaneous editing commands are described for markup completion,
markup cycling, indentation, etc.  Extensions, such as footnotes,
fenced code blocks, tables, wiki links, definition lists, and
checkboxes are described in the [Extensions](#extensions) chapter that follows.

![Markdown Menu in Emacs on macOS](images/menu-bar.png)

Markdown Mode keybindings are grouped by prefixes based on their
function.  Like other major modes, most commands begin with `C-c`, the
`mode-specific-command-prefix`.  Commands are then grouped by category
under a second-level prefix.  For example, the commands for styling
text are grouped under `C-c C-s` (`markdown-mode-style-map`).
Similarly, commands for running Markdown and performing maintenance
tasks reside under `C-c C-c` (`markdown-mode-command-map`).
Movement and shifting commands tend to be associated with paired
delimiters such as `M-{` and `M-}` or `C-c <` and `C-c >`.
If you have `menu-bar-mode` on, you can also access these commands
from the Markdown menu.

We begin with a summary of Markdown Mode prefixes and mnemonics.  The
commands in each group will be described in detail below.  You can
obtain a list of all keybindings by pressing `C-c C-h` or `C-h m`.  To
see commands under a specific prefix, add `C-h` to the end of the
prefix.  For example, press `C-c C-s C-h` to list all commands under
`C-c C-s`.

| Prefix    | Function               |
|-----------|------------------------|
| `C-c C-s` | **S**tyles             |
| `C-c C-l` | **L**inks              |
| `C-c C-i` | **I**mages             |
| `C-c C-c` | **C**ommands           |
| `C-c C-x` | Toggles                |

When you use the `C-c C-s` or `C-c C-c` prefixes, prompts will
appear in the minibuffer that provide hints for a few of the most
commonly used commands.  You can control this by setting
`markdown-enable-prefix-prompts`.

`markdown-enable-prefix-prompts`

:   Boolean, default: `t`.

    When non-`nil`, display prompts when certain prefix keys are
    pressed.  Set to `nil` to disable these prompts.

T> There are several Emacs packages for providing keybinding hints,
T> such as `which-key` and `guide-key`.  If you use one of these,
T> you can disable Markdown Mode's prefix prompts by setting
T> `markdown-enable-prefix-prompts` to `nil`.

The following sections describe many commands for inserting
markup---for headings, blockquotes, lists, source code, and so
on---and many of these commands behave differently depending on
whether `transient-mark-mode` is enabled or not.  When it makes sense,
if `transient-mark-mode` is on and there is an active region, the
command applies to the text in the region.  For example, `C-c C-s b`
(`markdown-insert-bold`) would make the region bold.  When
`transient-mark-mode` is off or there is no active region, many
commands then proceed to work with either the word at the point (e.g.,
for italics) or the current line (e.g., for headings).

There are also some parallel commands that act specifically on the
region, even when `transient-mark-mode` is disabled.  These commands
have the same keybindings as their standard counterparts but use an
uppercase letter instead.  For example, `markdown-insert-blockquote`
is bound to `C-c C-s q` while `markdown-blockquote-region` is bound to
`C-c C-s Q`.  The latter _always_ applies to the region while the former
only acts on the region when `transient-mark-mode` is on and the region
is active.

T> For users who prefer to work _without_ `transient-mark-mode`,
T> conveniently since Emacs 22 it can be enabled temporarily by pressing
T> `C-SPC C-SPC`.

## Headings

Headings in Markdown can be defined using either of two formats:
atx and setext.

Atx-style headings are lines beginning with one to six hash marks (`#`)
followed by the heading text.  The number of hash marks corresponds to
the level of the heading, with one being the most prominent and six
being the least prominent (corresponding to the six levels of headings
in HTML, `<h1>` through `<h6>`).  The heading text may optionally be
followed by an equal number of hash marks.

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# First-level heading #

First section text.  Here we close the heading with a hash mark.

## Second-level heading

Second section text.  No closing hash marks here.

### Third-level heading ###

Third section text.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The second type of headings supported in Markdown are called setext
headings, for which only two levels are defined.  Instead of being
surrounded by hash marks, equals signs (`=`) and hyphens (`-`) are
used to underline the heading text.

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
First-level heading
==================

Second-level heading
-------------------
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### Inserting & Replacing Headings

There are two options for inserting or replacing headings: you can
either insert a heading of a specific level and type or let Markdown
Mode determine the level and type for you.  To insert a heading of a
specific level directly, simply use `C-c C-s #` where `#` is a number
`1` through `6` (`markdown-insert-header-atx-1`, …,
`markdown-insert-header-atx-6`).

To insert setext headings directly, use
`C-c C-s !` (`markdown-insert-header-setext-1`) for level one
or `C-c C-s @` (`markdown-insert-header-setext-2`) for level two.
Noting that `!` is `S-1` and `@` is `S-2` may make these commands
easier to remember.

For automatic heading insertion use `C-c C-s h`
(`markdown-insert-header-dwim`).  The type and level are determined
based on the previous heading.  By default, the new heading will be a
sibling (same level).  A `C-u` prefix can be added to insert a heading
that is _promoted_ (lower number) by one level or a `C-u C-u` prefix
can be given to insert a heading that is _demoted_ (higher number) by
one level.

X> Suppose you are currently writing in a level-two section, as in the
X> following example, where `█` indicates the point:
X>
X> {lang="text"}
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X> ## Heading ##
X>
X> Body text.
X> █
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X>
X> Pressing `C-c C-s h`, for automatic heading insertion, creates a
X> new level-two sibling heading:
X>
X> {lang="text"}
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X> ## Heading ##
X> 
X> Body text.
X> 
X> ## █##
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X>
X> Using the universal prefix, as in `C-u C-c C-s h`, creates a
X> new level-one parent heading:
X>
X> {lang="text"}
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X> # █#
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X>
X> Using the universal prefix twice, as in `C-u C-u C-c C-s h`, creates a
X> new level-three child heading instead:
X>
X> {lang="text"}
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X> ### █###
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To automatically insert setext-style headings, use `C-c C-s H`
(`markdown-insert-header-setext-dwim`).  This command behaves
like `C-c C-c h` (`markdown-insert-header-dwim`) in that the level is
calculated automatically and it can accept the same prefix arguments,
but it uses setext (underlined) headings for levels one and two.

As with several other markup commands, if the region is active and
`transient-mark-mode` is on, the heading insertion commands use the
text in the region as the heading text.  Next, if the current line is
not blank, they use the text on the current line.  Otherwise, the user
is prompted to provide the heading text.

If the point is at a heading, these commands will replace the existing
markup in order to update the level or type of the heading.  This
is useful, for example, when the automatically-determined heading level
is not what you wanted: the heading level can be quickly changed as needed.

X> Suppose you mistakenly insert a level-two heading and want to
X> replace it, as in the following example:
X>
X> {lang="text"}
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X> ## Heading█##
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X>
X> Pressing `C-c C-s 1` replaces the heading with a level-one heading:
X>
X> {lang="text"}
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X> # Heading█#
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To remove the markup of the heading at the point, you can press `C-c C-k`
(`markdown-kill-thing-at-point`) to kill the heading and add the text
to the kill ring.  Press `C-y` to yank the heading text back into the
buffer.

I> Markdown.pl and several other processors allow one to omit the
I> whitespace between the hash mark and the heading text, but some
I> processors and specifications such as CommonMark do require the
I> whitespace.  To help guarantee compatibility, Markdown Mode also
I> requires whitespace.  This has other advantages, for example, it
I> allows one to use #hashtags that might wrap to the beginning of the
I> line.

T> If the length of the underline characters is not exactly right,
T> Markdown Mode can help keep things tidy by "completing" the markup
T> for you after the fact.  See the [Markup Completion](#completion) section of
T> this chapter for more details.

### Outline Navigation {#outline}

Markdown Mode defines keys for hierarchical navigation in headings and
lists.  When the point is in a list, they move between list items.
Otherwise, they move between headings.

*   Use `C-c C-n` and `C-c C-p` (`markdown-outline-previous` and
    `markdown-outline-next`) to move to the next and previous visible
    headings or list items _of any level_.
*   Similarly, `C-c C-f` and `C-c C-b`
    (`markdown-outline-previous-same-level` and `markdown-outline-next-same-level`)
    move to the next and previous visible headings or list items
    _at the same level_ as the one at the point.
*   Finally, `C-c C-u` (`markdown-outline-up`) will move up to the
    parent heading or list item.

T> The outline navigation commands in `markdown-mode` (`C-c C-n`,
T> `C-c C-p`, `C-c C-f`, `C-c C-b`, and `C-c C-u`) are the same as in
T> `org-mode`, which are in turn based on those in `outline-minor-mode`.

### Movement by Defun

The usual Emacs commands can be used to move by defuns (top-level
major definitions), but in Markdown Mode, **a defun is a section.** As
usual, `C-M-a` (`beginning-of-defun`) will move the point to the
beginning of the current or preceding defun, `C-M-e` (`end-of-defun`)
will move to the end of the current or following defun, and `C-M-h`
(`mark-defun`) will mark the current defun.  To narrow
the buffer to show only the current section, use `C-x n d`
(`narrow-to-defun`) and to widen again, use `C-x n w` (`widen`) as
usual.

T> Defuns in Emacs are major top-level definitions.  The name derives
T> from the Emacs Lisp `defun` macro for defining functions.  The
T> defun movement and marking commands in Markdown Mode (`C-M-a`,
T> `C-M-e`, and `C-M-h`) are the same as in Emacs more generally.
T> Since Markdown has no functions, Markdown Mode considers section
T> headings to be defuns.

To include the complete subtree (including any subsections) when
marking and narrowing, Markdown Mode also defines `C-c C-M-h`
(`markdown-mark-subtree`) and `C-x n s`
(`markdown-narrow-to-subtree`).

### Movement by Page

Markdown Mode also re-defines the "page" movement and marking commands
in Emacs, since they aren't otherwise useful in Markdown documents.
Elsewhere in Emacs, pages are defined by a regular expression given in
the `page-delimiter` variable, usually `^L` (control-L, the page break
control code).  Markdown Mode redefines a page to be a complete
top-level subtree, so you can navigate between top-level headings
using the standard Emacs page movement keys: `C-x [` and `C-x ]`
(`markdown-backward-page` and `markdown-forward-page`).  To
mark the current top-level subtree, use `C-x C-p`
(`markdown-mark-page`).  To narrow the buffer to show only the current
top-level subtree, use `C-x n p` (`markdown-narrow-to-page`) and to
widen again, use `C-x n w` (`widen`) as usual.

### Visibility Cycling

Markdown Mode supports `org-mode`-style visibility cycling for
headings and sections.  There are two types of visibility cycling:
global and local.

Pressing `S-TAB` (`markdown-shifttab`) cycles _globally_ between three
levels of visibility, as shown in the screenshot below:

1. headings only (overview),
2. top-level headings only (contents),
3. all sections visible (show all).

![Global Visibility Cycling](images/global-visibility.png)

On the other hand, pressing `TAB` (`markdown-tab`) while the point
is at a heading will cycle through three levels of visibility
_locally_ for the current subtree:

1. all subsections and sub-headings completely folded,
2. child headings visible,
3. all subsections and sub-headings fully visible.

### Subtree Editing

Entire subtrees of ATX headings can be promoted and demoted with
`C-c <left>` and `C-c <right>` (`markdown-promote` and
`markdown-demote`).  Conveniently, these are the same keybindings used
for promotion and demotion of list items.  If the point is at a list
item, they operate on the list item.  Otherwise, they operate on the
current heading subtree.  Similarly, subtrees can be moved up and down
with `C-c <up>` and `C-c <down>` (`markdown-move-up` and
`markdown-move-down`).

W> These commands are based on functions from `outline.el` that are
W> regular-expression-based, and so they currently do not work
W> properly if there are setext headings in the region.

Note the following "boundary" behavior for promotion and demotion.
Any level-six headings will not be demoted further (i.e., they remain
at level six, since Markdown and HTML do not define more than six
levels of headings) and any level-one headings will be promoted away
entirely (i.e., the heading markup will be removed, since level-zero
headings are undefined).

### Heading Customization

Markdown Mode distinguishes between _symmetric_ and _asymmetric_ atx
heading markup.  Symmetric headings have an equal number of hash marks
at the beginning and end of the line.  Asymmetric headings have only
leading hash marks.  Both are valid, so this is an aesthetic choice.
You can customize Markdown Mode to fit your preference by setting the
`markdown-asymmetric-header` variable.

`markdown-asymmetric-header`

:   `nil` or `t`, default: `nil`.

    Determines if atx heading style will be asymmetric.

    When `nil`, balanced markup will be inserted at the beginning and
    end of the line around the heading title.

    {lang="text}
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ## Heading ##
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    Set to a non-`nil` value to use asymmetric heading styling, placing
    heading markup only at the beginning of the line.

    {lang="text}
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ## Heading
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    _Example:_

    ``` emacs-lisp
    (setq markdown-asymmetric-header t)
    ```

Markdown Mode also has the ability to scale the font sizes used for
headings in proportion to their importance (as in AUCTeX, for
instance).  To enable this, customize `markdown-header-scaling` or set
it in your init file.

`markdown-header-scaling`

:   Boolean, default: `nil`.

    Determines whether Markdown Mode uses different font sizes for
    headings of different levels.  Set to a non-`nil` value to inherit
    from the `variable-pitch` for headings with font sizes that
    correspond to the scaling factors in the
    `markdown-header-scaling-values` list.

`markdown-header-scaling-values`

:   List of floats, default: `(2.0 1.7 1.4 1.1 1.0 1.0)`.

    List of six scaling values, relative to baseline, to use for
    headings of levels one through six.  Only used when
    `markdown-header-scaling` is non-`nil`.

For finer control over the heading faces, Markdown Mode defines
separate heading faces for each heading level:

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
markdown-header-face-1    markdown-header-face-4
markdown-header-face-2    markdown-header-face-5
markdown-header-face-3    markdown-header-face-6
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Each of these inherits from the common `markdown-header-face`.  So, to
change all faces (e.g., a common font family or color) you can
customize `markdown-header-face` directly.  To change the face used
for a specific heading level, customize that face individually.

T> `markdown-header-face` inherits from `variable-pitch` by default,
T> for contrast with the `default` face, which is a fixed width font by
T> default.  If you don't like the appearance of headings on your
T> system, first ensure that you are setting the family of
T> `variable-pitch` to something that pairs well with your `default`
T> font.

![Heading Marginalization](images/marginalize-headers.png)

To help with readability, Markdown Mode can also align the atx heading
text by moving the leading hash marks to the left margin.  This is
referred to in Markdown Mode as _header marginalization_.  To enable
this, customize `markdown-marginalize-headers` or set it to a
non-`nil` value in your init file.

`markdown-marginalize-headers`

:   Boolean, default: `nil`.

    When non-`nil`, put opening atx header markup in the left margin.

    This pairs well with `markdown-asymmetric-header`, but
    unfortunately it conflicts with other modes that use the left
    margin, such as `linum-mode`.

`markdown-marginalize-headers-margin-width`

:   Integer, default: 6.

    Character width of margin used for marginalized headers.  The
    default value is based on there being six heading levels defined
    by Markdown and HTML.  Increasing this produces extra whitespace
    on the left.  Decreasing it may be preferred when fewer than six
    nested heading levels are used.

## Paragraphs

A paragraph in Markdown is one or more consecutive lines of text
separated by one or more blank lines.  Normal paragraphs should not be
indented with spaces or tabs:

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This is a paragraph.  It has two sentences.

This is another paragraph.  It also has two sentences.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


## Blockquotes

To produce a blockquote (`<blockquote>` in HTML), prefix each line
with a right angle bracket (`>`), just as when quoting an email:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> This text will be enclosed in an HTML `<blockquote>` element.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Blockquotes may be nested, like so:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> Blockquote
>
> > Nested blockquote
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To insert markup for a blockquote in Markdown Mode, use `C-c C-s q`
(`markdown-insert-blockquote`).  When `transient-mark-mode` is
enabled, this command adds blockquote markup to the region,
when active.  Otherwise, it simply inserts markup for an empty
blockquote and positions the point appropriately.  The appropriate
amount of indentation, if any, is calculated automatically given the
surrounding context, but may be adjusted later using the region
indentation commands described in the [Indentation](#indentation)
section below.

If you want to specifically operate on the region, whether or not
`transient-mark-mode` and the region is active, you can use the
region-specific command `C-c C-s Q` (`markdown-blockquote-region`).

I> Notice that the keybinding for this command, `C-c C-s Q`, is
I> similar to `C-c C-s q` but the `Q` is uppercase.  This pattern is
I> also used with other paired or otherwise related commands in
I> Markdown Mode, such as atx and setext heading insertion.

T> The region-specific functions such as `markdown-blockquote-region`
T> are useful in some less obvious cases.  For example, yanking text
T> from the kill ring sets the mark at the beginning of the yanked
T> text and leaves the point at the end.  Therefore, even though the
T> region is not active (i.e., it is not highlighted) the region does
T> contain the yanked text and so `C-c C-s Q` will format it as a
T> blockquote.


## Lists

To produce an unordered list (`<ul>` in HTML), prefix each line with a
list marker.  Valid list marker characters are asterisks (`*`),
hyphens (`-`), and plus signs (`+`):

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* An item in a bulleted (unordered) list
* Another item in a bulleted list
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Ordered lists (`<ol>` in HTML) are created by prefixing
each line with a number followed by a period:

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. An item in an enumerated (ordered) list
2. Another item in an enumerated list
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To create a _nested list_, use four spaces to indent the markers of
subordinate items.  You may change list markers if you wish to
add more visual distinction.  Note that it is the marker indentation
that matters, not the whitespace following the marker.

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*   An item in a bulleted (unordered) list

    *   A sub-item in a nested list

1234567890
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

T> The four-space convention will show up again, for creating code
T> blocks.  For the broadest Markdown processor compatibility, it is
T> recommended to always use four spaces for indenting and nesting
T> elements.

I> [John Gruber conducted a Twitter Poll](https://daringfireball.net/2017/07/unordered_lists_in_markdown) in July 2017 to ask which
I> list markers were most popular among Markdown users.  Out of 4,545
I> responses, the results were:
I> 
I> *   Asterisk (`*`): 42%
I> *   Hyphen (`-`): 54%
I> *   Plus (`+`): 4%
I>
I> Gruber noted that he uses all three at times, and that different
I> characters can be used for different levels of nesting.

### Creating and Editing Lists

New list items can be inserted with `M-RET` or `C-c C-j`
(`markdown-insert-list-item`).  This command determines the
appropriate marker (one of the possible unordered list markers or the
next number in sequence for an ordered list) and indentation level by
examining nearby list items.  If there is no list before or after the
point, it starts a new list.

As with heading insertion, you may prefix `markdown-insert-list-item`
by `C-u` to decrease the indentation by one level.  Prefix this
command by `C-u C-u` to increase the indentation by one level.

Existing list items (and their nested sub-items) can be moved up and
down with `C-c <up>` and `C-c <down>` (`markdown-move-up` and
`markdown-move-down`).  List items can also be indented and outdented
with `C-c <right>` and `C-c <left>` (`markdown-demote` and
`markdown-promote`).

### List Navigation

The same keys used for heading outline navigation (`C-c C-n`,
`C-c C-p`, `C-c C-f`, `C-c C-b`, and `C-c C-u`) also work inside
nested lists.  See the [Outline Navigation](#outline) section for details.

### List Customization

You can customize the default unordered list item marker and spacing
by setting the variable `markdown-unordered-list-item-prefix`.  Also,
although it is not recommended to do so, if needed you can change the
default indentation amount by setting `markdown-list-indent-width`.

`markdown-unordered-list-item-prefix`

:   String, default: "&nbsp;&nbsp;*&nbsp;".

    String to be inserted to create an unordered list item.

    _Example:_

    ``` emacs-lisp
    (setq markdown-unordered-list-item-prefix "*   ")
    ```

`markdown-list-indent-width`

:   Integer, default: `4`.

    Depth of indentation for lists when inserting, promoting, and
    demoting list items.


## Paragraph & Block Movement

For the purposes of defining movement and marking commands, "paragraphs"
in Markdown Mode include not only regular paragraphs as described
above, but also paragraphs inside blockquotes, individual list items,
headings, etc.

To move the point from one paragraph to another, use
`M-{` and `M-}` (`markdown-backward-paragraph` and
`markdown-forward-paragraph`).  By default, these keys are bound to
`forward-paragraph` and `backward-paragraph`, but the built-in Emacs
functions are based on simple regular expressions that fail in
Markdown files.  To mark a paragraph, you can use
`M-h` (`markdown-mark-paragraph`).

Markdown Mode also defines "block" movement commands, which are larger
in scope and may contain multiple "paragraphs" in some cases.  Blocks
are considered to be entire lists, entire code blocks, and entire
blockquotes.  To move backward or forward by one block use
`C-M-{` and `C-M-}` (`markdown-beginning-block` and
`markdown-end-of-block`).  To mark a block, use `C-c M-h`
(`markdown-mark-block`).  To narrow the buffer to the current
block, use `C-x n b` (`markdown-narrow-to-block`) and to
widen again use `C-x n w` (`widen`).

To compare paragraph and block movement, consider some specific
examples.  In terms of list items, paragraph movement moves
item-by-item, regardless of the list item level.  On the other hand,
block movement moves across the entire list.  Suppose the point is at
the block, as in the following example:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Paragraph

- item 1
- item 2
- item 3
█
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Moving backwards by "paragraph" with `M-{` first moves the point back
to the marker for item 3, then back to the marker for item 2, and so
on.  Moving backwards by one "block" with `C-M-{`, on the other hand,
moves the point immediately to the marker for item 1.

Next, consider a blockquote with multiple paragraphs as in the following
example:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Regular paragraph

> blockquote paragraph 1
>
> blockquote paragraph 2.
█
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Moving backward by one paragraph leaves the point at the `>` before
blockquote paragraph 2 while moving backward by one block moves over
the entire blockquote and leaves the point at the `>` before
blockquote paragraph 1.

## Indentation {#indentation}

### The Tab Key

Markdown Mode attempts to be flexible in how it handles indentation.
When you press `TAB` (`markdown-tab`) repeatedly, the point will
cycle through several possible indentation levels corresponding to
locations you might have in mind.  For example, you may want to start
a new list item, continue a list item with hanging indentation, indent
for a nested `<pre>` block, and so on.

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- list item
    - nested list item
█
5   1 2 3   4
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The numbers in the block above represent the indentation positions
that are cycled through following a nested list when the point is at
the block above position 5.  In order, these positions would be appropriate
for 1) starting a new nested list item, 2) continuing the nested list
item with indentation past the marker, 3) starting a list item with a
deeper level of nesting, 4) adding a nested indented code block, and
5) starting a new list item at the top level of the list.

If you so desire, you can fully customize this behavior by writing
your own indentation function and setting the variable
`markdown-indent-function` appropriately.

`markdown-indent-function`

:   Function, default: `markdown-indent-line`.

    Function to use for automatic indentation.

### The Backspace Key

When `DEL` or `<backspace>` (`markdown-outdent-or-delete`) is pressed
at the beginning of the non-whitespace portion of a line, text will be
outdented similarly, but in the opposite direction as indentation.

### The Return Key

When the point is at the end of a (potentially nested) list item, code
block, etc. and you press `RET` (`markdown-enter-key`), what happens
next depends on the value of `markdown-indent-on-enter`.  As an example,
consider the following nested list.

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- list item
    - nested list item█
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When `markdown-indent-on-enter` is `nil`, the point will move to
column 0 of the following line:

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- list item
    - nested list item
█
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When `markdown-indent-on-enter` is set to `t`, the point will be
positioned for continuing your nested list.

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- list item
    - nested list item
    █
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In this scenario, if you wanted to continue your existing (now
line-wrapped) list item with hanging indentation, simply press `TAB`
to indent to the next logical position.

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- list item
    - nested list item
      █
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Finally, when `markdown-indent-on-enter` is set to
`indent-and-new-item`, Markdown Mode will automatically
insert a new list item.  With this setting, pressing `RET` again
removes the empty list item and leaves a blank line.  If you want
to insert a single literal newline, you can use `quoted-insert`
via `C-q C-j`.

{lang="text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- list item
    - nested list item
    - █
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

`markdown-indent-on-enter`

:   `nil`, `t`, or `indent-and-new-item`, default: `t`.

    When non-`nil`, automatically indent new lines when the enter key
    is pressed.  When set to `indent-and-new-item`, additionally
    insert a new list item marker if the point was in a list item.

### Shifting the Region

Text in the region can be outdented or indented as a single block using
`C-c <` and `C-c >`
(`markdown-outdent-region` and `markdown-indent-region`).
Text in the region will be shifted to the next indentation point
calculated in the current context, as discussed above.

T> The region indent and outdent keybindings are the same as those for
T> the corresponding commands in `python-mode`.

## Code Blocks

Code blocks in Markdown are formatted by prefixing each line with four
spaces:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    #include <stdio.h>
    int main()
    {
        printf("hello, world\n");
        return 0;
    }

1234567890
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To begin a new code block press `C-c C-s p` (`markdown-insert-pre`),
where `p` refers to the HTML `<pre>` tag used to format such a block.
When `transient-mark-mode` is enabled, this command also works on the
region, when active, or begins a new code block otherwise.

If you want to specifically operate on the region, whether it is
highlighted with `transient-mark-mode` or not, you can use the
region-specific command `C-c C-s P` (`markdown-pre-region`).
So, as with other commands, the lowercase and uppercase keybindings
are related.

T> Region-specific commands such as this one are useful when you have
T> just yanked some text and want to format it, say, as a code block.
T> Upon yanking, the mark moved to the beginning of the yanked text
T> and so the region is already set appropriately.

I> In addition to indented code blocks, or pre blocks, Markdown Mode
I> also supports several variations referred to as fenced code blocks.
I> Rather than being indented, fenced code blocks are surrounded above
I> and below by strings of tildes or backquotes.  We will return to
I> fenced code blocks later, in the [Extensions](#extensions) chapter.

## Horizontal Rules

Horizontal rules, corresponding to `<hr>` tags in HTML, are created in
Markdown by placing three or more hyphens, asterisks, or underscores
on a line by themselves.  You may use spaces between the characters if
you prefer, but the characters cannot be mixed.  Each of the following
lines will produce a horizontal rule:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
---
- - -
* * *
________________________________________
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To insert a horizontal rule, press `C-c C-s -` (`markdown-insert-hr`).
Markdown Mode allows
you to define several horizontal rules of decreasing prominence in a
list variable named `markdown-hr-strings`.  By default, this
command inserts the first string in `markdown-hr-strings`---the most
prominent one.  With a `C-u` prefix, insert the last string.  With a
numeric prefix `N`, insert the string in position `N` (starting at 1).
The list of strings inserted by Markdown Mode can be customized by
redefining the variable `markdown-hr-strings`.

`markdown-hr-strings`

:   List of strings.

    Strings to use when inserting horizontal rules.

W> Different strings will not be distinguished when converted to
W> HTML---they will all be converted to `<hr>` tags---but they may add visual
W> distinction and style to plain text documents.  To maintain notions
W> of promotion and demotion, these should be ordered from largest to
W> smallest.

T> To insert a specific horizontal rule from the `markdown-hr-strings`
T> list, use a prefix argument to `C-c C-s -`, as in `C-# C-c C-s -`
T> where `#` is the index of the string in the list.

I> In the default `markdown-hr-strings` list, the longest two strings
I> are 79 characters long, rather than 80 characters long, to prevent
I> a line wrap indicator from appearing in the right fringe when the
I> window is exactly 80 characters wide.  However, the list is fully
I> customizable and if you prefer an 80-character-wide string you can
I> set this variable in your local configuration.

## Emphasis: Italic & Bold

To emphasize text in Markdown, surround it with asterisks or
underscores.  For _italics_, use single asterisks or underscores:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*italic* or _italic_
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Similarly, enclose **bold** text between two asterisks or two
underscores:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
**bold** or __bold__
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In Markdown Mode, `C-c C-s i` (`markdown-insert-italic`) inserts
markup to make the region or a word italic.  If `transient-mark-mode`
is on and there is an active region, it wraps the region in italic
markup.  Else, if the point is at a non-italic word, make the word
italic, or if the point is at an italic word or phrase, remove
(toggle) the markup.  Otherwise, simply insert italic markup and place
the point in the middle.

Similarly, use `C-c C-s b` (`markdown-insert-bold`) for bold text.
This command works in exactly the same way as
`markdown-insert-italic`.

Like the three possible list markers, the use of asterisks or
underscores for italic or bold text is a personal preference in
Markdown.  Markdown Mode lets you customize the default choice
for inserting new markup via two variables described below.

I> Brett Terpstra, in his [Write better Markdown](http://brettterpstra.com/2015/08/24/write-better-markdown/) style
I> guide, recommends maintaining a consistent style with respect to
I> asterisks and underscores throughout a document.  For example, you
I> might always use underscores for italics and asterisks for bold.

T> You can also _toggle_ between asterisks and underscores using the
T> promotion and demotion commands, `C-c C--` and `C-c C-=`
T> (`markdown-promote` and `markdown-demote`).

W> Markdown processors differ as to how they handle inter-word
W> underscores.  When Markdown.pl encounters `_dis_functional`, it
W> assumes you intend to italicize "dis".  However, if you are writing
W> technical documentation, perhaps you have a variable named
W> `state_space_dimension`.  Unless you format that as inline code,
W> then the middle word---`space`---would become italicized.  GitHub Flavored
W> Markdown re-defines this behavior so that inter-word underscores do
W> not trigger italics.  Markdown Mode includes a special
W> mode, [GitHub Flavored Markdown Mode](#gfm) or `gfm-mode`, and among
W> other differences, it uses the GitHub convention for underscores.
W> This mode is described in the section on [GitHub Flavored Markdown](#gfm)
W> in the [Extensions](#extensions) chapter.

`markdown-italic-underscore`

:   Boolean, default: `nil`.

    Set to a non-`nil` value to use underscores instead of asterisks
    when inserting markup for italic text.

    _Example:_

    ``` emacs-lisp
    (setq markdown-italic-underscore t)
    ```

`markdown-bold-underscore`

:   Boolean, default: `nil`.

    Set to a non-`nil` value to use two underscores instead of two
    asterisks when inserting markup for bold text.

    _Example:_

    ``` emacs-lisp
    (setq markdown-bold-underscore nil)
    ```

## Inline Code

To mark up inline source code, for command names, file names, etc.,
place the text between backquotes (`` ` ``) like so:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This is inline code: `printf("hello, world\n");`
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To insert inline code in Markdown Mode, use `C-c C-s c`
(`markdown-insert-code`).  This command works for both insertion and
toggling and it uses the region when appropriate, just like the
bold and italic commands.

T> Because Markdown is often used for technical documentation (e.g.,
T> README files on GitHub), Markdown Mode also provides `C-c C-s k`
T> (`markdown-insert-kbd`) for inserting HTML `<kbd>` tags, for which
T> there is no Markdown equivalent.  In terms of font lock, `<kbd>`
T> tags are treated like inline code but of course they may be styled
T> differently on websites and elsewhere.

## Links & Images

To create simple links, you can simply place a URL or email address
inside angle brackets:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<https://www.gnu.org/software/emacs/>
<bug-gnu-emacs@gnu.org>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To create hyperlinks---text with an associated URL---place the link
text in square brackets followed by the URL in parentheses:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[Link text](http://link.url/)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Optionally, you can add "title text" (for the HTML `title` attribute)
to the link which will appear when the user's mouse pointer hovers
over the link:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[Link text](http://link.url/ "Title text")
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A similar syntax is used for images: just add an exclamation point
(`!`) before the square bracket.  There is no equivalent of link text
for images, so instead the text in square brackets will be used as the
"alt text" (for the HTML `alt` attribute):

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
![Alt text](http://link.url/image.jpg "Title text")
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In Markdown Mode, links of the above form are referred to as "inline
links" because the URL is written out in full inline in the Markdown
text.  On the other hand, "reference links" allow you to keep the text
clean and define the URLs later:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
You can define short reference link like this:
[link text here][1]

[1]: http://link.url/

You can still include a title, like this:
[link text here][ref]

[ref]: http://link.url/ "Title text"

Finally, you can use implicitly defined reference links
where the reference label is the same as the link text:
[link text][]

[link text]: http://link.url/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### Inserting Links & Images

For links, `C-c C-l` (`markdown-insert-link`) is the general command
for inserting new link markup or editing existing link markup
interactively.  This command can be used to insert links of any form:
either inline links, reference links, or plain URLs in angle brackets.
The URL or reference label, link text, and optional title are
provided through a series of prompts.  The type of link is determined
by which values are provided:

*   Given a URL and link text, insert an inline link:
    `[text](url)`.
*   Given a `[reference]` and link text, insert
    a reference link: `[text][reference]`.
*   Given only link text, insert an implicit reference link:
    `[text][]`.
*   Given only a URL, insert a plain URL:
    `<url>`.

Similarly, `C-c C-i` (`markdown-insert-image`) is a general command for
inserting or editing image markup interactively.  As with the link
insertion command, through a series of interactive prompts you can insert
either an inline or reference image:

*   Given a URL and alt text, insert an inline image:
    `![alt](url)`.
*   Given a `[reference]` and alt text, insert a reference image:
    `![alt][reference]`.

If there is an existing link or image at the point, these commands will
edit the existing markup rather than inserting new markup.  Otherwise,
if `transient-mark-mode` is on and there is an active region, these
commands use the region as either the default URL (if it seems to be a
URL) or link text value otherwise.  In that case, the region will be
replaced by the link.

If a reference label is given that is not yet defined, you
will be prompted for the URL and optional title and the
reference definition will be inserted according to the value of
`markdown-reference-location`.  If a title is given, it will be
added to the end of the reference definition and will be used
to populate the HTML `title` attribute when exported.

You can use `C-c C-d` (`markdown-do`) to jump between reference labels
and reference definitions.  If more than one link uses the same
reference label, a window will be shown with clickable buttons
for jumping to each link.  Pressing `TAB` or `S-TAB` cycles between
buttons in this window.

T> Note that interactive functions `C-c C-l` and `C-c C-i` can be used
T> to convert links and images from one type to another (inline,
T> reference, or plain URL) by selectively adding or removing
T> properties via the interactive prompts.

X> As an example, suppose you have an inline link of the form
X> `[text](url)` and want to convert it to a plain URL link as in
X> `<url>`.  If you press `C-c C-l` and leave the URL as is when prompted
X> but remove the link text, then a plain URL, as in `<url>`, will be
X> inserted in place of the inline link.  If you removed the URL
X> instead, then you would be prompted for a reference label.

### Following Links

Links in Markdown Mode are clickable and clicking one will open the URL in
the default browser.  To follow a link using the keyboard, press `C-c C-o`
(`markdown-follow-thing-at-point`) when the point is on an inline or
reference link.  Use `M-p` and `M-n`
(`markdown-previous-link` and `markdown-next-link`) to quickly jump to
the previous or next link of any type.

### URL Hiding {#url-hiding}

Markdown Mode makes it possible to hide URLs for inline and reference
links, which can make your text more readable.  This feature can be
toggled as needed using `C-c C-x C-l` (`markdown-toggle-url-hiding`)
or from the Markdown menu.  When URL hiding is enabled, the URL
components of links will be displayed as a single, customizable
character (`∞` by default).  That is, URLs will appear as `[link](∞)`
instead of `[link](long/url)`.

URL hiding is accomplished in Emacs using _composition_, so the URLs
are still part of the buffer.  To change the placeholder (composition)
character used, set the variable `markdown-url-compose-char`.

When URL hiding is enabled, the link properties will be displayed in
the minibuffer along with a hint to use `C-c C-l` for editing the
link.  You can also edit a URL directly by deleting the final
parenthesis, which disables fontification of the link and thus removes
the composition property.  Finally, you can also hover your mouse
pointer over the link text to see the URL.

`markdown-hide-urls`

:   Boolean, default: `nil`.

    Determines whether URL and reference labels are hidden for inline
    and reference links.  This can be toggled interactively using
    `C-c C-x C-l` (`markdown-toggle-url-hiding`).

`markdown-url-compose-char`

:   Character or list of characters, default: 0x221e (infinity),
    0x2026 (horizontal ellipsis), 0xx22ef (midline horizontal
    ellipsis), 0x23 (number sign), 0x2605 (black star), 0x2693
    (anchor).

    Placeholder character for hidden URLs.

    This may be a single character or a list of characters.  In case
    of a list, the first which satisfies `char-displayable-p` will be
    used.

T> The interactive link and image commands `C-c C-l` and `C-c C-i`
T> are especially useful when markup or URL hiding is enabled, in
T> which case it is more difficult to edit URLs.

### Link & Image Customizations

Certain aspects of link and image insertion can be customized, such as
the default location of reference links and the protocol schemes of URLs
that should be recognized automatically.

`markdown-reference-location`

:   `immediately`, `header`, `subtree`, or `end`, default: `header`.

    Determines where to insert reference definitions.  The possible
    locations are the end of the document (`end`), after the current
    block (`immediately`), the end of the current subtree (`subtree`),
    or before the next heading (`header`).

    _Example:_

    ``` emacs-lisp
    (setq markdown-reference-location 'end)
    ```

`markdown-uri-types`

:   List of strings.

    A list of protocol schemes ("http", "ftp", etc.) for URLs that
    Markdown Mode should highlight.

### Inline Image Display

{width=80%}
![Inline Image Display in Markdown Mode](images/inline-images.png)

Local images associated with image links may be displayed inline in
the buffer by pressing
`C-c C-x C-i` or `M-x markdown-toggle-inline-images`.
This is a toggle command, so pressing this again will remove inline
images.

High resolution images may be rendered very large in Emacs buffers,
but if your Emacs is compiled with ImageMagick support they can be
scaled down automatically by setting `markdown-max-image-size`.

`markdown-max-image-size`

:   Cons of integers or `nil`, default: `nil`.

    Maximum width and height for displayed inline images.  This
    variable may be nil or a cons cell (MAX-WIDTH . MAX-HEIGHT).  When
    `nil`, use the actual size.  Otherwise, use ImageMagick to resize
    larger images to be of the given maximum dimensions.  This
    requires Emacs to be built with ImageMagick support.

    _Example:_

    ``` emacs-lisp
    (setq markdown-max-image-size '(640 . 480))
    ```

## Line Breaks

In Markdown, whitespace at the end of a line is meaningful.  Adding
two trailing spaces at the end of a line creates a hard line break.
Markdown Mode highlights these spaces to draw attention to possibly
spurious whitespace.  Markdown Mode also respects hard line breaks
when filling paragraphs.

## HTML

Most Markdown processors also support inline HTML tags and HTML
blocks.  As such, Markdown Mode provides optional syntax highlighting
for HTML tags.

`markdown-enable-html`

:   Boolean, default: `t`.

    Enable font lock for HTML tags and attributes.

## Killing Elements

Press `C-c C-k` (`markdown-kill-thing-at-point`) to kill the thing at
point and add the most important text, without markup, to the kill
ring.  Possible entities to kill include (roughly in order of
precedence): inline code, headings, horizontal rules, links (adds the
link text to kill ring), images (adds the alt text to kill ring),
plain URLs, email addresses, bold, italics, reference definitions
(adds URL to kill ring), footnote markers and text (kills both the
marker and text, adds text to kill ring), and list items.  See the
following table for a summary.

| Killed Entity              | Kill Ring   |
|----------------------------|-------------|
| `` `code` ``               | "code"      |
| `# Heading`                | "Heading"   |
| `-----`                    | `nil`       |
| `[text](url)`              | "text"      |
| `[text][ref]`              | "text"      |
| `![alt](url)`              | "alt"       |
| `![alt][ref]`              | "alt"       |
| `<url>`                    | "url"       |
| `_text_`                   | "text"      |
| `**text**`                 | "text"      |
| `[ref]: url`               | "url"       |
| `[^fn]`, `[^fn]: footnote`  | "footnote"  |
| `* List item`              | "List item" |

## Markdown Do

Markdown Mode defines `C-c C-d` (`markdown-do`), a command for doing
something sensible with the object at the point.  Depending on the
context, it does the following:

*   Jumps between reference links and reference definitions.

*   Jumps between footnote markers and footnote text.

*   Toggles the completion status of GFM task list items (checkboxes).

*   Inserts a new GFM task list item.

I> The Markdown Do command has evolved over the past three versions of
I> Markdown Mode.  It derives from a previous command named
I> `markdown-jump`, which was previously bound to `C-c C-j` in
I> Markdown Mode 2.1.  It was later moved to `C-c C-l`
I> in Markdown Mode 2.2 to allow using `C-c C-j` (in addition
I> to `M-RET`) for inserting list items, as in AUCTeX mode.
I> In Markdown Mode 2.3, this command has been imbued with additional
I> functionality, rebranded as `markdown-do`, and moved to `C-c C-d`
I> to make way for the new interactive link editing command `C-c C-l`.

## Markup Promotion & Demotion

Markdown Mode allows certain markup (headings, for example) to be
_promoted_ and _demoted_.  Press `C-c C--` or `C-c <left>`
(`markdown-promote`) to promote the element at the point if possible.
Similarly, `C-c C-=` or `C-c <right>` (`markdown-demote`) to demote
the element at the point.

Headings, horizontal rules, and list items can be promoted and
demoted, as well as bold and italic text.  For headings, promotion
means _decreasing_ the level (i.e., from `<h2>` to `<h1>`) while
demotion means _increasing_ the level (i.e., from `<h2>` to `<h3>`).
For horizontal rules, promotion and demotion mean moving backward or
forward through the `markdown-hr-strings` list.  For bold and italic
text, promotion and demotion mean switching the markup from underscores
to asterisks and back.

T> To promote or demote markup at the point, where applicable, use
T> `C-c C--` and `C-c C-=`.  To remember the promotion and demotion
T> commands, note that `-` is for decreasing the level, and `=` (on
T> the same key as `+`) is for increasing the level.  Similarly, the
T> left and right arrow keys indicate the direction in which the atx
T> heading markup will move when promoting or demoting.

T> You can change the level of a heading level two ways:
T>
T> 1. Using markup cycling, with either `C-c C--` and `C-c C-=` or the
T>    alternatives `C-c <left>` and `C-c <right>`.
T> 2. By re-issuing a heading insertion command when the point is at a
T>    heading.  For example, `C-c C-s 4` will replace the current heading
T>    (of any level) with a level-four heading.

## Markup Completion {#completion}

_Complete markup_ refers to markup in normalized form.  This means,
for example, that the underlined portion of a setext heading is the same
length as the heading text, or that the number of leading and trailing
hash marks of an atx heading are equal and that there is no extra
whitespace.  To complete any incomplete markup at the point, press
`C-c C-]` (`markdown-complete`).

X> Suppose a buffer contains the following headings, one with an
X> underline that is too short and another with extra whitespace and
X> a missing hash mark:
X>
X> {lang="text"}
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X> Heading 1
X> ===
X>
X> ##  Heading 2 #
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X>
X> Markup completion via `C-c C-]` will adjust them as follows:
X>
X> {lang="text"}
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
X> Heading 1
X> =========
X>
X> ## Heading 2 ##
X> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

## Markdown Maintenance Commands

Markdown Mode also provides some _global_ maintenance commands under the
`C-c C-c` prefix for checking references, cleaning up list numbers,
and completing markup in the buffer.

`C-c C-c c (markdown-check-refs)`

:   Checks the buffer for undefined references.  If there are any, a
    small buffer will open with a list of undefined references and the
    line numbers on which they appear.  Selecting a reference from
    this list and pressing `RET` will insert an empty reference
    definition at the end of the buffer.  Selecting the line number
    instead will move the point to the location of the undefined
    reference.

`C-c C-c n (markdown-cleanup-list-numbers)`

:   Renumbers any ordered lists in the buffer that are out of
    sequence.  Note that the sequence is not important for rendering
    HTML---a list with numbers `1.`, `1.`, …, `1.` is perfectly
    fine---but this command is useful if you prefer to also maintain
    accurate plain text numbering.

`C-c C-c ] (markdown-complete-buffer)`

:   Completes all heading markup and normalizes all horizontal rules
    in the buffer.

------------------------------------------------------------------------------

# Extensions {#extensions}

## Fenced Code Blocks

In addition to indented code blocks, Markdown Mode also supports
_fenced code blocks_.  Although fenced code blocks are not universally
supported by all Markdown processors, a primary advantage is that they
allow authors to indicate the name of the language of the source code
contained within, to assist with syntax highlighting and CSS styling.
They also remove the need to maintain the four-space leading
indentation, which can make editing code blocks more difficult.

### GFM Code Blocks

The first type of fenced code blocks supported by Markdown Mode are those
used by [GitHub-Flavored Markdown (GFM)](http://github.github.com/github-flavored-markdown/).  These blocks begin and end
with three consecutive backquotes on separate lines.  After the
opening three backquotes, you may give an optional language
identifier, optionally separated by whitespace.  These are referred to in
Markdown Mode simply as GFM code blocks:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~
```
a one-line code block
```

```python
print("hello, world")
```

``` Ruby
puts("hello, world")
```
~~~~~~~~~~~~~~~~~~~~~~~~

To insert a GFM code block interactively in Markdown Mode, press
`C-c C-s C` (`markdown-insert-gfm-code-block`).  You will be presented
with a minibuffer prompt asking for an optional programming language name.
Markdown Mode includes a large list of known languages to select from.
The default value will be the most recently used language.
If you do not want to add an explicit languge identifier, you can
press `C-g` at the prompt and a block with on language will be inserted.

The GFM programming language prompt uses `completing-read`, which has
several useful keybindings such as `M-n` and `M-p` to select the next
or previous elements and `M-s` and `M-r` to select the next or
previous elements matching a partially complete string.

T> Since it uses `completing-read`, programming language selection
T> will also work with `ido`, `ivy`, and `helm`.

Another way to insert a GFM code block is to use the _electric
backquote_ feature, which is enabled by default.  When this setting is
enabled, pressing the backquote key (`` ` ``) three times triggers
`markdown-insert-gfm-code-block` automatically.  At present, this
feature is only enabled in `gfm-mode`.

`markdown-gfm-use-electric-backquote`

:   Boolean, default: `t`.

    When non-`nil`, trigger interactive insertion of GFM code blocks
    when the backquote key is pressed three times.

Additionally, you can augment the list of known language names by
setting `markdown-gfm-additional-languages` and you can indicate a
preference for lowercase language identifiers with
`markdown-gfm-downcase-languages`.

`markdown-gfm-additional-languages`

:   List of strings, default: `nil`.

    This variable contains additional languages to make available, aside
    from those predefined in `markdown-gfm-recognized-languages`, when
    inserting GFM code blocks.  Language strings must be trimmed
    of whitespace and not contain curly braces.  They may be of
    arbitrary capitalization.

    _Example:_

    ``` emacs-lisp
    (setq markdown-gfm-additional-languages '("Texinfo" "Zimbu"))
    ```

`markdown-gfm-downcase-languages`

:   Boolean, default: `t`.

    When non-`nil`, apply `downcase` to suggested programming language
    names to convert them to lowercase.

`markdown-spaces-after-code-fence`

:   Integer, default: `1`.

    Number of space characters to insert between an opening code fence
    and the optional programming language name.

    _Example:_

    ``` emacs-lisp
    (setq markdown-spaces-after-code-fence 0)
    ```

### Tilde-Fenced Code Blocks

The second type of fenced code blocks supported by Markdown Mode are
tilde-fenced code blocks.  Markdown processors supporting this
extension include [PHP Markdown Extra](https://michelf.ca/projects/php-markdown/extra/), [Pandoc](http://pandoc.org), and
[Leanpub](https://leanpub.com/help/manual) among others.  The block opens with _at least three_
tildes (`~`) and closes with at least as many tildes as it was opened
with (but possibly more):

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~
a one-line code block
~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

I> Markdown Mode supports font-lock and indirect editing of
I> tilde-fenced code blocks, but it does not yet include a
I> dedicated command for inserting them.

### Language Strings

Some processors allow you to specify the language of the source code
using attribute lists of various formats, as in the following
examples.  Markdown Mode takes an inclusive approach to highlighting
such blocks by allowing optional braces, periods, `lang` attributes,
and so on:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```{r, eval=FALSE}
summary(gdp)
```

~~~~~~~~~~~~~~~~~~~ .html
<p>hello, world</p>
~~~~~~~~~~~~~~~~~~~

~~~~{.python}
print("hello, world")
~~~~

~~~~~~~ {: lang=fortran }
program main
  print *, 'hello, world'
end program main
~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

### Native Font Lock and Indirect Editing

{width=80%}
![Native Font Lock for a JavaScript Code Block](images/native-font-lock.png)

Markdown Mode can also optionally perform native syntax highlighting
of source code in fenced code blocks.  This works for GFM and
tilde-fenced code blocks for which a language name has been specified.
You can toggle this mode with either `C-c C-x C-f` or
`M-x markdown-toggle-fontify-code-blocks-natively` and you can set the
default behavior by customizing the variable
`markdown-fontify-code-blocks-natively`.

`markdown-fontify-code-blocks-natively`

:   Boolean, default: `nil`.

    When non-`nil`, fontify code in code blocks using the native major
    mode.  This only works for fenced code blocks where the language
    is specified and where Markdown Mode can automatically determine
    the appropriate mode to use.

`markdown-edit-code-block-default-mode`

:   Function or nil, default: `nil`

    Default mode to use for native fontification of code blocks.  This
    mode is used when automatic detection fails, such as for code
    blocks with no language specified.

Additionally, if you have the [`edit-indirect`](https://github.com/Fanael/edit-indirect/)
package installed
Markdown Mode can open code blocks for editing in an "indirect" buffer
with the native major mode enabled.  To do this, press `C-c '`
(`markdown-edit-code-block`).  A new window will open with the
contents of the code block and with the guessed major mode enabled.
The code block in the Markdown buffer will be highlighted to indicate
that it is being edited elsewhere.  When you are finished editing in
the indirect buffer, press `C-c C-c` (`edit-indirect-commit`)
to "commit" any changes and update the Markdown buffer or press
`C-c C-k` (`edit-indirect-abort`) to cancel and ignore any changes.

T> If you want to simultaneously insert and edit a GFM code block, you
T> can give a prefix argument to `markdown-insert-gfm-code-block`
T> as in `C-u C-c C-s C`.  This is a shortcut that issues the insertion
T> (`C-c C-s C`) and indirect edit (`C-c '`) in one operation.

{width=80%}
![Editing a GFM Code Block in an Indirect Buffer](images/edit-indirect.png)

Both native font lock and indirect editing require Markdown Mode to
try to determine the appropriate mode to use for each language identifier.
Sometimes this is straightforward.  For example, `shell` maps to `shell-mode`
and `emacs-lisp` maps to `emacs-lisp-mode`.  In other cases, the language
and mode names may not agree or a different mode may be desired.
The language-to-mode mapping may be customized as needed by setting the
variable `markdown-code-lang-modes`.

`markdown-code-lang-modes`

:   Association list.

    An alist mapping languages to their major modes.  Keys are strings
    representing language names and values are major mode symbols.
    For example, a default element of this alist is `("sqlite"
    . sql-mode)`, which instructs Markdown Mode to use `sql-mode` to
    highlight and edit `sqlite` code blocks.

In practice, the language-to-mode mapping is handled by the
`markdown-get-lang-mode` function, which looks for a defined function
satisfying one of the following forms, in order, where `<lang>`
represents the language keyword specified for the code block:

1. An entry with key `<lang>` specified in `markdown-code-lang-modes`.
2. A function named `<lang>-mode`.

X> As an example, suppose you have a code block with language name `matlab`.
X> By default, there is no element of `markdown-code-lang-modes` with
X> key `matlab`, so Markdown Mode checks to see if `matlab-mode` is defined.
X> If so, it will be used for syntax highlighting of the code block and also
X> for indirect editing of the code block.

If a language is not specified, or a suitable mode is not found by
`markdown-get-lang-mode`, then `markdown-edit-code-block-default-mode`
will be used for editing the code block (but not for fontification).

`markdown-edit-code-block-default-mode`

:   Function or nil, default: `normal-mode`.

    Default mode to use for editing code blocks.  This mode is used
    when automatic detection fails, such as for code blocks with no
    language specified.

## Footnotes

Footnotes are another common and reasonably standardized extension to
Markdown.  Footnotes consist of an inline marker, such as `[^fn]` and
a definition, where the footnote text is given:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Paragraph text.[^fn]

[^fn]: Footnote text.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To insert a footnote in Markdown Mode press `C-c C-s f`
(`markdown-insert-footnote`).  This inserts a footnote marker such as
`[^1]` at the point, inserts a footnote definition below, and
positions the point for typing the footnote text.  Footnotes inserted
this way are numbered, and the counter advances automatically.

W> This footnote syntax is an extension to Markdown and although it is
W> in common use, it is not supported by all processors.

As with reference links, you can customize the location of footnote
definitions.  Similarly, you can use `C-c C-d` (`markdown-do`) to jump
between footnote markers and footnote definitions.

`markdown-footnote-location`

:   `immediately`, `header`, `subtree`, or `end`, default: `end`.

    Determines where to insert footnote text.  The set of location
    options is the same as for `markdown-reference-location`: the
    possible locations are the end of the document (`end`), after the
    current block (`immediately`), the end of the current subtree
    (`subtree`), or before the next heading (`header`).

    _Example:_

    ``` emacs-lisp
    (setq markdown-footnote-location 'subtree)
    ```

`markdown-footnote-display`

:   Display specification, default: `((raise 0.2) (height 0.8))`.

    The `display` property specification for footnote markers and
    inline footnotes.  By default, footnote text is reduced in size and
    raised.  Set to `nil` if you wish to disable this.

T> Markdown Mode also includes basic font lock support for Pandoc's
T> _inline footnotes_:
T>
T> {lang="text"}
T> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
T> Here is an inline footnote.^[Footnote text here.]
T> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
T>
T> This is, however, a processor-specific extension.

## Tables

Although there is no official table syntax in Markdown, many Markdown
processors do include support for tables.  The most widely used table
syntax, and the one supported by Markdown Mode, can be introduced by
example:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
| Right | Left | Center | Default |
|------:|:-----|:------:|---------|
|    12 | 12   | 12     | 12      |
|   123 | 123  | 123    | 123     |
|     1 | 1    | 1      | 1       |
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The first line contains the column headers and is followed by a
horizontal separator line.  The next three lines are regular table
rows.  Columns are always separated by the pipe character (`|`) and
colons can optionally be used to specify column alignment.[^separator]

This syntax is compatible with that proposed by PHP Markdown Extra and
adopted by many subsequent Markdown processors such as Pandoc
(`pipe_tables` extension), MultiMarkdown, Leanpub, and Python Markdown
(Tables extension), among others.

T> Although PHP Markdown Extra and other processors support tables
T> without opening and closing pipe characters, these characters are
T> required for proper detection of tables in Markdown Mode.

[^separator]: Any line starting with `|-` or `|:` is considered to be
a horizontal separator line.  Whitespace is not allowed between the
opening pipe character and header separator symbol.

### Inserting Tables

There are two ways to create new tables in Markdown Mode.  The
simplest approach is to simply start type the headings, separated by
pipes, and optionally begin a separator line on a new line, like so
(where `█` indicates the point):

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~
|Right|Left|Center|Default|
|-█
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Pressing `TAB` will then align the table and allow you to begin
entering data in the cells:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
| Right | Left | Center | Default |
|-------|------|--------|---------|
| █     |      |        |         |
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A second way to create a new table is to convert the region to a table
using `C-c C-c |` (`markdown-table-convert-region`).  This function
attempts to recognize comma, tab, and space separated data and split
the data into cells appropriately.  For example, both of the following
regions (where `⇥` denotes a tab, for clarity) will be converted to the
same table:

{lang="text"}
~~~~~~~~~~~~~
1,New York
2,Los Angeles
3,Chicago
4,Houston
5,Phoenix
~~~~~~~~~~~~~

{lang="text"}
~~~~~~~~~~~~~
1⇥New York
2⇥Los Angeles
3⇥Chicago
4⇥Houston
5⇥Phoenix
~~~~~~~~~~~~~

Using `C-c C-c |` with both of these regions yields the following
table:

{lang="text"}
~~~~~~~~~~~~~~~~~~~
| 1 | New York    |
| 2 | Los Angeles |
| 3 | Chicago     |
| 4 | Houston     |
| 5 | Phoenix     |
~~~~~~~~~~~~~~~~~~~

However, if spaces are used as delimiters instead of commas or tabs,
the result may be unexpected:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~
| 1 | New     | York    |
| 2 | Los     | Angeles |
| 3 | Chicago |         |
| 4 | Houston |         |
| 5 | Phoenix |         |
~~~~~~~~~~~~~~~~~~~~~~~~~

### Navigating in Tables

Once you have a table in a Markdown Mode buffer, you can press `TAB`
to move to the next cell.  This moves from left to right and then to
the beginning of the next row.  When the end of the table is reached,
pressing `TAB` creates a new empty row.  Pressing `S-TAB` moves
cell-by-cell in reverse.  Similarly, press `RET` to move to the next
row in the same column.  This creates a new empty row at the end of
the table or before horizontal separator lines.

### Editing Tables

Markdown Mode contains functions that assist in editing tables in
several ways: you can realign tables, rearrange their rows and
columns, sort the rows, kill their rows and columns, insert new rows
and columns, or transpose the rows and columns.  There are keybindings
for each of these functions, described below, and if you have
`menu-bar-mode` enabled you can also issue these commands from the
Markdown menu.

Although alignment isn't important when using a Markdown processor to
convert to HTML, you might want to keep your tables _aligned_ to improve
plain text readability.  Realignment happens automatically when using
the navigation commands `TAB`, `S-TAB`, and `RET`.  If needed, you can
also manually realign tables using `C-c C-d` (`markdown-do`) when the
point is inside a table.

I> The table editing functions try to handle markup hiding correctly
I> when calculating column widths, however, columns containing hidden
I> markup may not always be aligned properly.

As with list items, you can _move_ table rows up and down with
`C-c <up>` (`markdown-move-up`) and
`C-c <down>` (`markdown-move-down`).
Likewise, to move columns left or right use
`C-c <left>` (`markdown-demote`) and
`C-c <right>` (`markdown-promote`).

To _kill_ the current row, press `C-c S-<up>`
(`markdown-table-delete-row`), or to kill the current column, press
`C-c S-<left>` (`markdown-table-delete-column`).

On the other hand, to _insert_ a new row use `C-c S-<down>`
(`markdown-table-insert-row`).  This will insert a new row _above_ the
current row, but with an optional `C-u` argument the row will be
inserted below instead.  Similarly, to insert a new column, use `C-C
S-<right>` (`markdown-table-insert-column`).  The new column will be
inserted to the left of the current one.

You can _sort_ the lines of a table alphabetically or numerically by
pressing `C-c C-c ^` (`markdown-table-sort-lines`).  This command
prompts you for a column to sort on and a sort method.  Press a number
`N` to denote the column and then press either `a` or `n` for
alphabetical or numerical sort, or `A` or `N` for reverse alphabetical
or numerical sort.  For example, sorting our table of U.S. cities on
column `2` in alphabetical (`a`) order yields:

{lang="text"}
~~~~~~~~~~~~~~~~~~~
| 3 | Chicago     |
| 4 | Houston     |
| 2 | Los Angeles |
| 1 | New York    |
| 5 | Phoenix     |
~~~~~~~~~~~~~~~~~~~

Finally, you can _transpose_ a table with `C-c C-c t`
(`markdown-table-transpose`).  This operation swaps the rows and
columns.  For example, transposing our table of U.S. cities yields the
following:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
| 1        | 2           | 3       | 4       | 5       |
| New York | Los Angeles | Chicago | Houston | Phoenix |
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

## Definition Lists

Several Markdown processors, such as PHP Markdown Extra, Pandoc,
MultiMarkdown, and Python Markdown, support an extension called
_definition lists_, which correspond to `<dl>` tags in HTML.  A simple
definition list begins with a term followed by a newline and a colon
at the beginning of the next line, which separates the definition:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Term
:   Definition
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In HTML, this becomes:

``` html
<dl>
<dt>Term</dt>
<dd><p>Definition</p></dd>
</dl>
```

As with many words in a typical dictionary, you can specify multiple
definitions per term.  To borrow an example from the PHP Markdown
Extra documentation:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Apple
:   Pomaceous fruit of plants of the genus Malus in
    the family Rosaceae.
:   An American computer company.

Orange
:   The fruit of an evergreen tree of the genus Citrus.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Markdown Mode provides basic syntax highlighting and filling for
definition lists, and some of the list-related commands previously
described also work for definition lists.  For example, you can move
items up and down with `C-c <up>` (`markdown-move-up`) and `C-c <down>`
(`markdown-move-down`).  However, Markdown Mode does not yet provide
dedicated commands for inserting or otherwise manipulating definition
lists.

## Comments

Although there is no official syntax for comments in Markdown, since
it is most often converted to HTML the most natural comment syntax is that
used in HTML: `<!-- comment -->`.  You can use the usual Emacs commands
in Markdown Mode for commenting and uncommenting:

`M-; (comment-dwim)`

:   Insert or align comment on the current line.  If `transient-mark-mode`
    is on and the region is active, invoke `comment-region` instead
    (unless the region is a block of comments, in which case invoke
    `uncomment-region`).

`C-x C-; (comment-line)`

:   Comment or uncomment the current line.

`C-u M-; (comment-kill)`

:   Kill a comment on the current line.

## Task List Items (Checkboxes)

GitHub Flavored Markdown (GFM) defines a syntax for task lists (i.e.,
checkboxes) which is a straightforward and backward-compatible
modification of Markdown's unordered list syntax.

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- [ ] Incomplete task
- [x] Completed task
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To insert a new GFM task list item, or to add a checkbox to an
existing list item, use `C-c C-s [` (`markdown-insert-gfm-checkbox`).
You can toggle checkboxes using either the dedicated toggle command
`C-c C-x C-x` (`markdown-toggle-gfm-checkbox`) or the context-specific
command `C-c C-d` (`markdown-do`).  By default, Markdown Mode also
activates these checkboxes so that they can be clicked using the
mouse, or by pressing `RET` when the point is at a checkbox.

`markdown-make-gfm-checkboxes-buttons`

:   Boolean, default: `t`.

    Determines whether GitHub Flavored Markdown style task lists
    (checkboxes) should be turned into buttons that can be toggled
    with `mouse-1` or `RET`.  When non-`nil`, buttons are enabled.
    This works both in `markdown-mode` and `gfm-mode`.

`markdown-gfm-uppercase-checkbox`

:   Boolean, default: `nil`.

    When non-`nil`, complete GFM task list items with the uppercase
    `[X]` instead of the lowercase `[x]`.  This is primarily useful
    for compatibility with Org Mode, which doesn't recognize the
    lowercase form.  GFM, however, supports both forms.

## Subscripts and Superscripts

Pandoc and MultiMarkdown, among other Markdown processors, support
extensions for subscripts and superscripts.  Markdown Mode supports
this syntax as well.  Superscripts may be written by placing carets
(`^`) immediately before and after the text.  Similarly, subscripts
may be written by placing tildes (`~`) immediately before and after
the text.

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
H~2~O is a liquid.  2^10^ is 1024.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

`markdown-sub-superscript-display`

:   Cons of display specifications, default:
    `(((raise -0.3) (height 0.7)) . ((raise 0.3) (height 0.7)))`

    The `display` property specifications for subscript and
    superscripts when markup hiding is enabled.  The car is used for
    subscript, the cdr is used for superscripts.  By default,
    superscripts are raised, subscripts are lowered, and both are
    reduced in size.  Set to `(nil . nil)` if you wish to disable
    this.

## Metadata

Markdown Mode provides font lock support for several common metadata
formats, such as those supported by MultiMarkdown, Pandoc, and GitHub.

One of the simplest forms is email-style metadata that must appear at
the beginning of the file.  This metadata format is supported by
MultiMarkdown and some blog generation systems.

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
title: Guide to Markdown Mode for Emacs
author: Jason R. Blevins
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Markdown Mode also supports Pandoc metadata, which also must appear at
the beginning of a file and is indicated by percent signs:

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% title
% author(s) (separated by semicolons)
% date
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Finally, Markdown Mode supports YAML and TOML metadata blocks.  YAML
and TOML metadata blocks begin with a line of three hyphens (`---`)
and end with either a line of three hyphens (`---`) or three dots
(`...`).  Pandoc, GitHub, and Jekyll all support YAML metadata.

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
---
title: Guide to Markdown Mode for Emacs
author: Jason R. Blevins
tags: Emacs, markdown, markdown-mode, writing, plain text
---
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Some website generators, such as Hugo, also support TOML metadata.

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
---
title = "Guide to Markdown Mode for Emacs"
author = "Jason R. Blevins"
---
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Optionally, Markdown Mode allows YAML and TOML metadata to occur
anywhere in the document.  This is disabled by default, for
performance reasons, but you can customize
`markdown-use-pandoc-style-yaml-metadata` to enable it.

`markdown-use-pandoc-style-yaml-metadata`

:   Boolean, default: `nil`.

    When non-`nil`, allow YAML and TOML metadata anywhere in the
    document.

## Wiki Links {#wiki-links}

Markdown Mode also supports syntax highlighting for `[[Wiki Links]]`.
Note that wiki links are an extension to Markdown and are not
supported by all processors, so this support is disabled by default.
Support can be toggled with `M-x markdown-toggle-wiki-links` or by
setting `markdown-enable-wiki-links`.

To insert a wiki link, use `C-c C-s w` (`markdown-insert-wiki-link`).
If `transient-mark-mode` is on and there is an active region, this
command will use the region as the link text.  If the point is at a
word, use the word as the link text.  If there is no active region and
the point is not at word, it will simply insert empty wiki link brackets.

Wiki links may be followed by pressing `C-c C-o` when the point is at
a wiki link.  This will find the corresponding file in the current
window, by default, or in another window when the `C-u` prefix is
given.  As with regular links, you can use `M-p` and `M-n` to quickly
jump to the previous and next links (including other kinds of links).

Aliased or piped wiki links of the form `[[link text|PageName]]` are
also supported.  Since some wiki engines reverse these components, set
`markdown-wiki-link-alias-first` to nil to treat them as
`[[PageName|link text]]` instead.

By default, Markdown Mode only searches for target files in the
current directory.  Sequential subdirectory search can be enabled by
setting `markdown-wiki-link-search-subdirectories` to a non-`nil`
value.  Similarly, sequential parent directory search can be enabled
by setting `markdown-wiki-link-search-parent-directories` to a
non-`nil` value.

`markdown-enable-wiki-links`

:   Boolean, default: `nil`.

    Enable or disable syntax highlighting for wiki links.  Set this
    variable to a non-`nil` value to enable wiki link support.  Wiki
    link support can also be toggled interactively using the function
    `markdown-toggle-wiki-links`.

    _Example:_

    ``` emacs-lisp
    (setq markdown-enable-wiki-links t)
    ```

`markdown-wiki-link-alias-first`

:   Boolean, default: `t`.

    Set to a non-`nil` value to treat aliased wiki links like
    `[[link text|PageName]]`.  When set to `nil`,
    they will be treated as `[[PageName|link text]]`.

`markdown-link-space-sub-char`

:   String, default: `"_"` in `markdown-mode` and `"-"` in `gfm-mode`.

    Character to replace spaces when mapping wiki links to filenames.
    For example, use an underscore for compatibility with the Python
    Markdown WikiLinks extension.  In GFM Mode, this is set to `"-"`
    to conform with the GitHub wiki link conventions.

    _Example:_

    ``` emacs-lisp
    (setq markdown-link-space-sub-char "-")
    ```

`markdown-wiki-link-fontify-missing`

:   Boolean, default: `nil`.

    When non-`nil`, set wiki link faces according to the
    existence or absence of target files.

    _Example:_

    ``` emacs-lisp
    (setq markdown-wiki-link-fontify-missing t)
    ```

    W> Note that this is expensive because it requires checking each
    W> linked file every time the buffer changes or the user switches
    W> windows.  It is disabled by default because it may cause lag when
    W> typing on slower machines.

`markdown-wiki-link-search-subdirectories`

:   Boolean, default: `nil`.

    When non-`nil`, search for wiki link targets in subdirectories.
    This is the default search behavior for GitHub, so this variable
    is automatically set to `t` in `gfm-mode`.

`markdown-wiki-link-search-parent-directories`

:   Boolean, default: `nil`.

    When non-`nil`, search for wiki link targets in parent directories.
    This is the default search behavior of the [Ikiwiki](https://ikiwiki.info) engine.


## Mathematical Expressions (LaTeX) {#math}

{width=60%}
![LaTeX Math in Markdown Mode](images/math.png)

Syntax highlighting for mathematical expressions written in LaTeX can
be toggling with `C-c C-x C-e` (`markdown-toggle-math`), where
the final `e` is for _equation_.  Importantly, this is _not_ full
LaTeX support.  It only involves font lock and only for expressions
delimited by `$..$`, `$$..$$`, `\[..\]`, or `\\[..\\]` are supported;
this does not yet include dedicated commands for inserting or otherwise
manipulating mathematical markup.

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A simple equation for a line in $\mathbb{R}^2$:

\[ y = mx + b \]

Again, but with dollar signs:

$$ y = mx + b $$

Delimiters with two backslashes:

\\[
\Gamma(x) = \int_0^\infty t^{x-1}{\mathrm{e}}^{-t}\,{\mathrm{d}}
\\]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Alternatively, you can enable this by default by setting
`markdown-enable-math` to a non-`nil` value.  You can do this on a
file-by-file basis using [File Local Variables](#file-local).  Or you can enable
this setting globally, via `M-x customize` or by placing `(setq
markdown-enable-math t)` in your startup file.  In that case, you
should restart Emacs or call `markdown-reload-extensions`.

`markdown-enable-math`

:   Boolean, default: `nil`.

    Enable syntax highlighting for LaTeX expressions.


## GitHub Flavored Markdown (GFM) Mode {#gfm}

[GitHub Flavored Markdown](http://github.github.com/github-flavored-markdown/) is a dialect of Markdown developed for use on GitHub.
A GitHub Flavored Markdown Mode for Emacs is also available
as `gfm-mode` and is part of the Markdown Mode package.

The GitHub implementation of Markdown differs slightly
from standard Markdown in that it supports things like different
behavior for underscores inside of words, automatic linking of URLs,
strikethrough text, and fenced code blocks with an optional language
keyword.  Many of these extensions have been discussed already, but
here we address them collectively in relation to `gfm-mode`.

On GitHub, the GFM-specific features above apply to `README.md` files,
wiki pages, and other Markdown-formatted files in repositories on
GitHub.  GitHub also enables [additional features](https://help.github.com/articles/writing-on-github/) for writing on
the site (for issues, pull requests, messages, etc.)  that are further
extensions of GFM.  These features include task lists (checkboxes),
newlines corresponding to hard line breaks, auto-linked references to
issues and commits, wiki links, and so on.  To make matters more
confusing, although task lists are not part of [GFM proper](http://github.github.com/github-flavored-markdown/),
[since 2014](https://github.com/blog/1825-task-lists-in-all-markdown-documents) they are rendered (in a read-only fashion) in all
Markdown documents in repositories on the site.  These additional
extensions are supported to varying degrees by Markdown Mode and GFM
Mode as described below.

* **URL auto-linking:**  Both Markdown Mode and GFM Mode support
  highlighting of URLs even without angle brackets.

* **Underscores inside words:**  You must enable GFM Mode to
  toggle support for underscores inside of words. In this mode
  variable names such as `a_test_variable` will not trigger
  italics.

* **Fenced code blocks:**  Code blocks between triple backquotes
  (```` ``` ````), with optional programming language keywords, are
  highlighted in both Markdown Mode and GFM Mode.  They can be
  inserted with `C-c C-s C` (`markdown-insert-gfm-code-block`) or by
  typing three backquotes when `markdown-electric-backquote` is
  non-`nil`.

* **Strikethrough:**  Strikethrough text is supported in both Markdown
  Mode and GFM Mode and can be inserted (and toggled) using
  `C-c C-s s` (`markdown-insert-strike-through`).

* **Task lists:** GFM task lists will be rendered as checkboxes,
  implemented using Emacs buttons, in both Markdown Mode and GFM Mode
  when `markdown-make-gfm-checkboxes-buttons` is set to a non-`nil`
  value (and this variable is `t` by default).  These checkboxes can
  be toggled by clicking `mouse-1`, pressing `RET` over the button, or
  by pressing `C-c C-d` (`markdown-do`) with the point anywhere in the
  task list item.  Alternatively, you can use the dedicated function
  `C-c C-x C-x` (`markdown-toggle-gfm-checkbox`) directly.

* **Wiki links:**  Generic wiki links are supported in
  Markdown Mode, but in GFM Mode specifically they will be
  treated as they are on GitHub: spaces will be replaced by hyphens
  in file names and the first letter of the file name will be
  capitalized.  For example, `[[wiki link]]` will map to a file
  named `Wiki-link` with the same extension as the current file.

* **Newlines:**  Neither Markdown Mode nor GFM Mode does anything
  specifically with respect to newline behavior.  If you use
  GFM Mode mostly to write text _for comments or issues_ on the
  GitHub site---where newlines are indeed significant and correspond
  to hard line breaks---then you may want to enable `visual-line-mode`
  for line wrapping in buffers.  You can do this with a
  `gfm-mode-hook` as follows:

  ``` emacs-lisp
  ;; Use visual-line-mode in gfm-mode
  (defun my-gfm-mode-hook ()
    (visual-line-mode 1))
  (add-hook 'gfm-mode-hook 'my-gfm-mode-hook)
  ```

* **Preview:** GFM-specific preview can be powered by setting
  `markdown-command` to use [Docter](https://github.com/alampros/Docter) (which, as of this writing, is
  unfortunately no longer maintained).  This may also be configured to
  work with [Marked 2](https://geo.itunes.apple.com/us/app/marked-2/id890031187?mt=12&at=11l5Vs) for `markdown-open-command`.  See the [Tips](#tips)
  chapter for details.

------------------------------------------------------------------------------

# Previewing & Exporting Files {#preview-export}

There are a variety of ways to preview and export files in Markdown
Mode.  Perhaps the simplest way to quickly "preview" what your
Markdown will look like on the web is to hide the markup in the buffer
itself.  Several other options are available which make use of an
external Markdown processor (e.g., Markdown.pl, Pandoc, or
MultiMarkdown).  The various methods for previewing and exporting are
summarized in the following table and described in more detail in the
sections that follow.

| Description        | Keybinding    | Destination/Viewer              |
|--------------------|---------------|---------------------------------|
| Hide Markup        | `C-c C-x C-m` | Same buffer                     |
| Compile            | `C-c C-c m`   | `*markdown-output*` buffer      |
| Kill Ring Save     | `C-c C-c w`   | Kill ring                       |
| Preview            | `C-c C-c p`   | Browser (temporary file)        |
| Export             | `C-c C-c e`   | `<basename>.html`               |
| Export & View      | `C-c C-c v`   | `<basename>.html`, then browser |
| Live Preview       | `C-c C-c l`   | `eww` in an Emacs buffer        |
| Open               | `C-c C-c o`   | `markdown-open-command`         |
| Markdown View Mode |               | `markdown-view-mode`            |
| GFM View Mode      |               | `gfm-view-mode`                 |

Some of these commands involve the additional step of sending the
contents of the buffer to an external processor (`markdown-command`)
to convert Markdown to HTML.  Exceptions to this are Hide Markup,
Open, Markdown View, and the dedicated Markdown and GFM View modes.

I> To use Compile and other command commands that make use of an
I> external Markdown processor, `markdown-command` must be configured
I> as described in the [Configuring Markdown](#configuring-markdown)
I> section.

The Preview and Export commands are similar and worthy of more
discussion.  The difference is that when _previewing_, the output is
written to a temporary file that is then opened in a browser.  When
_exporting_, the output is written to a file named like the one being
visited, with the extension changed to `.html` instead, but the file
is not opened.  On the other hand, _viewing_ is a combination of
exporting and previewing: the file is saved permanently and then
also opened for viewing.

W> For the Export and View commands, the output file of form
W> `<basename>.html` will be overwritten without notice.

T> The table above lists the keybindings for carrying out these
T> commands, but they are also available from the Markdown menu
T> when `menu-bar-mode` is enabled.

## Markup Hiding {#markup-hiding}

_Markup hiding_ with `C-c C-x C-m` or `M-x markdown-toggle-markup-hiding`
is one simple way to preview (and even edit) files.  The side-by-side
screenshots below illustrate the effects of this.  Most markup will be hidden,
including asterisks and underscores for italics and bold, square brackets and
URLs for links, backquotes for inline code and fenced code blocks.

![Markup Hiding in Markdown Mode](images/markup-hiding.png)

Note that markup hiding supersedes [URL hiding](#url-hiding).  With
markup hiding, the URL and surrounding markup is hidden entirely,
while with URL hiding, only the URL itself is replaced by a
composition character.

When [Markup Hiding](#markup-hiding) is enabled, the `>` prefix for blockquotes
will be displayed as a special box drawing character.  Horizontal
rules, similarly, will be displayed using a line drawing character.
List markers for unordered lists will be displayed using Unicode
bullets, with different bullets for each level of nesting.  Definition
list markers, similarly, will be displayed using an alternative glyph.
The alternative display characters can be changed by customizing the
following variables.

`markdown-blockquote-display-char`

:   String or list of strings,
    default: 0x258C (left half block), 0x2503 (box drawings heavy
    vertical).[^unicode]

    String displayed when hiding blockquote markup.

    This may be a single string or a list of strings.  In case
    of a list, the first string for which all characters satisfy
    `char-displayable-p` will be used.

`markdown-hr-display-char`

:   Character or list of characters,
    default: `─`, `━`, `-`.

    Character for hiding horizontal rule markup.

    This may be a single character or a list of characters.  In case
    of a list, the first character that satisfies `char-displayable-p`
    will be used.

`markdown-definition-display-char`

:   Character or list of characters, default: 0x2058 (four dot
    punctuation), 0x2059 (five dot punctuation), 0x2261 (identical
    to), 0x2311 (square lozenge), 0x25ca (lozenge), 0x3a (colon).

    Character for replacing definition list markup.

    This may be a single character or a list of characters.  In case
    of a list, the first character that satisfies `char-displayable-p`
    will be used.

`markdown-list-item-bullets`

:   List of strings, default: 0x25cf (black circle), 0x25ce
    (bullseye), 0x25cb (white circle), 0x25c6 (black diamond), 0x25c7
    (white diamond), 0x25ba (black right-pointing pointer), 0x2022
    (bullet).

    List of bullets to use for unordered lists.  It can contain any
    number of symbols, which will be repeated if nesting exceeds the
    list length.

I> Markup hiding works by adding text properties to positions in the
I> buffer---either the `invisible` property or the `display` property
I> in cases where alternative glyphs are used (e.g., list bullets).
I> _This does not, however, affect printing or other output._
I> Functions such as `htmlfontify-buffer` and `ps-print-buffer` will
I> not honor these text properties.  For printing, it would be better
I> to convert to HTML or PDF first (e.g., using Pandoc) and then
I> print.

[^unicode]: Technical limitations prevent some characters from being displayed in the text.  UTF-16 encodings and entity names are listed instead.

## Compiling to a Temporary Buffer or the Kill Ring

_Compiling_ (i.e., running Markdown) with `C-c C-c m`
(`markdown-other-window`) will send the
contents of the current buffer to `markdown-command` and show the
output in a temporary `*markdown-output*` buffer.

![Markdown Output in a Separate Window](images/markdown-output.png)

As an alternative, rather than displaying the output in another
buffer you can save the output directly to the kill ring with
`C-c C-c w` (`markdown-kill-ring-save`).

## Static HTML Preview

_Previewing_ the current buffer with `C-c C-c p` (`markdown-preview`)
runs Markdown on the current buffer, stores the output in a temporary
file, and opens or "previews" the file in the default browser.

T> See the [Tips](#tips) chapter for details on how to configure the
T> default browser in Emacs, and how to link to or include a custom
T> stylesheet.

## Static HTML Export & View

_Exporting_ with `C-c C-c e` (`markdown-export`) will run Markdown
(`markdown-command`) on the current buffer and save the result in the
file `<basename>.html`, where `<basename>` is the name of the Markdown
file visited by the current buffer, with the extension removed.

X> As an example, if you are editing a file named `notes.md`, then the
X> corresponding export file name would be `notes.html`.

Similarly _viewing_ with `C-c C-c v` (`markdown-export-and-preview`)
is the same as _exporting_ the file and opening it in the default
browser.

## Live Preview Mode

![Live Preview Mode with the `eww` Browser](images/live-preview.png)

Markdown Mode also includes a live preview mode, which opens a preview
window in `eww`, which is a built-in browser available in Emacs.  An
idle timer periodically refreshes the HTML generated by
`markdown-command`.  Press `C-c C-c l` to toggle
`markdown-live-preview-mode`.

`markdown-split-window-direction`

:   `any`, `right`, or `below`, default: `any`.

    Preference for splitting windows for static and live preview.  The
    default value is `any`, which instructs Emacs to use
    `split-window-sensibly` to automatically choose how to split
    windows based on the values of `split-width-threshold` and
    `split-height-threshold` and the current window configuration.  To
    force vertically split windows (left and right), set this to
    `right`.  To force horizontally split windows, set this to
    `below`.

    _Example:_

    ``` emacs-lisp
    (setq markdown-split-window-direction 'right)
    ```

`markdown-live-preview-delete-export`

:   `nil`, `delete-on-export`, or `delete-on-destroy`,
    default: `delete-on-destroy`.

    Whether and when to delete the exported HTML file when using
    `markdown-live-preview-export`.  If set to `delete-on-export`,
    delete on every export.  When set to `delete-on-destroy`, delete
    when quitting `markdown-live-preview-mode`.  If set to `nil`,
    never delete.

T> For more complex configurations,
T> `markdown-live-preview-window-function` can be customized to open
T> in a browser other than `eww`.

## Opening in a Standalone Markdown Previewer

A final option for previewing files is to use an external previewer
with `C-c C-c o` (`markdown-open`).  The program used to preview files
is specified by the `markdown-open-command` variable, which must be
customized to use an available external previewer on your system.

`markdown-open-command`

:   File, function, or `nil`, default: `nil`.

    The command or function used for calling a standalone Markdown
    previewer capable of opening Markdown source files directly.  When
    this is a string corresponding to an executable, it will be called
    with a single argument, the file name of the current buffer.
    When this variable is a function, it will be called without
    arguments to preview the current buffer.  This command will be
    executed asynchronously.

    _Example:_

    ``` emacs-lisp
    (setq markdown-open-command "/usr/local/bin/mark")
    ```

T> As described in the [Tips](#tips) chapter, one popular viewer on macOS
T> is [Marked 2](https://geo.itunes.apple.com/us/app/marked-2/id890031187?mt=12&at=11l5Vs), which can easily be used as with Markdown Mode
T> with a simple shell script acting as a `markdown-open-command`
T> wrapper.

## Markdown and GFM View Modes

Two read-only viewing modes, `markdown-view-mode` and `gfm-view-mode`
are also provided for viewing Markdown content.  These modes provide
simplified keybindings for navigating the buffer.  Many of these are
like `help-mode` and `view-mode`, such as `SPC`, `DEL`, `<`, and `>`
for scrolling, `q` for quitting, and `?` or `h` for help.  Other keys
are provided that mirror the outline navigation commands when editing:
`n`, `p`, `f`, `b`, and `u`.  Both of these modes enable markup hiding
by default, but this can be customized by setting
`markdown-hide-markup-in-view-modes`.

## Preview & Export Customization

`markdown-xhtml-standalone-regexp`

:   String, default: `"^\\(<\\?xml\\|<!DOCTYPE\\|<html\\)"`.

    The regular expression that Markdown Mode uses to determine whether
    the output of `markdown-command` is a standalone HTML document or
    an HTML fragment.  If this regular expression not matched in the
    first five lines of output, Markdown Mode assumes the output is a
    fragment and adds a header and footer.

`markdown-css-paths`

:   List of strings, default: `nil`.

    A list of CSS files (URLs) to link to in the HTML output.

`markdown-content-type`

:   String, default: `""`.

    When set to a nonempty string, an `http-equiv` attribute will be
    included in the HTML `<head>` block.  If needed, the suggested
    values are `application/xhtml+xml` or `text/html`.  See also:
    `markdown-coding-system`.

    ``` emacs-lisp
    (setq markdown-content-type "application/xhtml+xml")
    ```

`markdown-coding-system`

:   String, default: `nil`.

    Used for specifying the character set identifier in the
    `http-equiv` attribute when included.  See
    `markdown-content-type`, which must be set before this variable
    has any effect.  When set to `nil`, `buffer-file-coding-system`
    will be used to automatically determine the coding system string
    (falling back to `iso-8859-1` when unavailable).  Common settings
    are `utf-8` and `iso-latin-1`.

    _Example:_

    ``` emacs-lisp
    (setq markdown-coding-system "utf-8")
    ```

`markdown-xhtml-header-content`

:   String, default: `""`.

    Additional content to include in the HTML `<head>` block.

    _Example:_

    ``` emacs-lisp
    (setq markdown-xhtml-header-content
          (concat "<link rel=\"shortcut icon\""
                  " href=\"/favicon.ico\""
                  " type=\"image/png\"/>"))
    ```

`markdown-xhtml-body-preamble`

:   String, default: `""`.

    Additional content to include in the XHTML `<body>` block, before
    the Markdown output.

    _Example:_

    ``` emacs-lisp
    (setq markdown-xhtml-body-preamble "<div id='content'>")
    ```

`markdown-xhtml-body-epilogue`

:   String, default: `""`.

    Additional content to include in the XHTML `<body>` block, after
    the Markdown output.

    _Example:_

    ``` emacs-lisp
    (setq markdown-xhtml-body-preamble "</div")
    ```

`markdown-export-kill-buffer`

:   Boolean, default: `t`.

    Kill output buffer after HTML export.  When non-`nil`, kill the
    HTML output buffer after exporting with `markdown-export`.
    Otherwise, keep it alive.

`markdown-before-export-hook`

:   List of functions, default: `nil`.

    Hook run before running `markdown-command` to export HTML output.
    The hook may modify the buffer, which will be restored to the
    original state after exporting is complete.

`markdown-after-export-hook`

:   List of functions, default: `nil`.

    Hook run after HTML output has been saved.  Any changes to the
    output buffer made by this hook will be saved.

`markdown-hide-markup-in-view-modes`

:   Boolean, default: `t`.

    When non-`nil`, enable hidden markup mode to hide Markdown markup
    when using `markdown-view-mode` and `gfm-view-mode`.

------------------------------------------------------------------------------

# Tips {#tips}

This chapter contains additional tips about using Markdown Mode and
integration with other third-party packages.

## Using Markdown Mode with Other File Extensions {#file-extensions}

Markdown Mode contains `autoload` statements to automatically
associate itself with `.md` and `.markdown` files in
`auto-mode-alist`.  If you use another file extension for your
Markdown files, say `.text`, then you can also ask Emacs to load
`markdown-mode` automatically for `.text` files by adding the
following to your init file:

``` emacs-lisp
(add-to-list 'auto-mode-alist '("\\.text\\'" . markdown-mode))
```

Alternatively, if you load packages with `use-package`, you can
achieve the same thing using the `:mode` keyword, like so:

``` emacs-lisp
(use-package markdown-mode
  :mode (("\\.text\\'" . markdown-mode)))
```

T> This is a macro and after expanding it with
T> `pp-macroexpand-last-sexp` we see that it is equivalent to
T> auto-loading `markdown-mode` and updating `auto-mode-alist`:
T> 
T> ``` emacs-lisp
T> (progn
T>   (unless
T>       (fboundp 'markdown-mode)
T>     (autoload #'markdown-mode "markdown-mode" nil t))
T>   (ignore
T>    (add-to-list 'auto-mode-alist
T>                 '("\\.text\\'" . markdown-mode))))
T> ```

## Switching and Toggling Markup

There are a couple of ways to quickly switch or toggle markup in
Markdown Mode (e.g., from bold to italic).  As an example, suppose
you type `**italic**` and want to change it to `*italic*`.  You can
quickly fix the mistake in at least two ways.

1. **Using the kill ring:**  Move the point to the erroneously bold
   word and press `C-c C-k` (`markdown-kill-thing-at-point`).  This
   removes the bold text and adds "italic", without the asterisks, to
   the kill ring.  Then press `C-c C-s i` to insert an empty italic
   span and yank in the "italic" text with `C-y`.

2. **Using markup toggling:**  Markdown Mode allows you to "toggle"
   certain markup, including that for bold, italic, and inline code,
   by repeating the insertion command.  Returning to the example, you
   can press `C-c C-s b` to first remove (toggle) the bold asterisks,
   leaving only "italic" behind.  Then, pressing `C-c C-s i` surrounds
   the word with single asterisks.

These methods also apply to other forms of markup such as inline code
and even links.

You can also toggle between asterisks and underscores as needed.
Suppose that you have `__bold__` in the buffer and want to use
asterisks instead.  Both will render in HTML as bold, but you might
have a preference for the latter in plain text.  You can use the
Markdown Mode cycling commands to switch between underscores and
asterisks in bold and italic phrases by pressing either `C-c C--` or
`C-c C-=` (`markdown-promote` or `markdown-demote`).


## Linking to or Including Custom CSS

The default stylesheet for HTML in most browsers is rather plain by
design, so you may want to use a custom stylesheet by either linking
to an external stylesheet or including a `<style>` block in the
exported HTML itself.

![Default and Custom CSS in Markdown Mode Output](images/custom-css.png)

### Linking to an External Stylesheet

The easiest way to customize the style of previewed and exported HTML
output is to link to an existing CSS stylesheet.  Markdown Mode has a
customizable variable `markdown-css-paths`, which is a list of
stylesheets to link to.  For each path or URL in `markdown-css-paths`,
a line like the following will be included in the HTML output:

``` html
<link rel="stylesheet" type="text/css" media="all" href="URL" />
```

Noting that the variable is a list, one can specify a single CSS path
on the local filesystem like so:

``` emacs-lisp
(setq markdown-css-paths '("/path/to/custom.css"))
```

On the other hand, to link to an existing URL you can use the
following form:

``` emacs-lisp
(setq markdown-css-paths '("http://mydomain.com/style.css"))
```

As another example, the [Marked 2](https://geo.itunes.apple.com/us/app/marked-2/id890031187?mt=12&at=11l5Vs) previewer contains several
built-in stylesheets that users can choose between.  Conveniently,
these stylesheets are stored on the filesystem as CSS files inside the
application package and you can link to them locally.  To use the
"Lopash" style when previewing from `markdown-mode`, you can set the
`markdown-css-paths` list as follows:

``` emacs-lisp
(setq markdown-css-paths
    '("/Applications/Marked 2.app/Contents/Resources/Lopash.css"))
```

If you don't have a stylesheet already, there are many popular
Markdown stylesheets available online.  For example, here are three
such repositories on GitHub:

*   <http://markdowncss.github.io>
*   <http://jasonm23.github.io/markdown-css-themes/>
*   <https://sindresorhus.com/github-markdown-css/>

### Embedding a Custom Stylesheet

As an alternative to linking to an external stylesheet, you can also
include inline style information in output files by using the
`markdown-xhtml-header-content` variable.  This variable specifies a
string to add to the `<head>` block of the HTML output.

X> For example, to remove the default underline property from links,
X> but temporarily underline links when hovering, you can include the
X> following `<style>` block via `markdown-xhtml-header-content`:
X>
X> ``` emacs-lisp
X> (setq markdown-xhtml-header-content
X>       "<style type='text/css'>
X> a { text-decoration: none; }
X> a:hover { text-decoration: underline; }
X> </style>")
X> ```

T> For more advanced customization, there are two export hooks available:
T> `markdown-before-export-hook` and `markdown-after-export-hook`.


## Imenu and Imenu-List

Markdown Mode includes support for `imenu`, an interface for quickly
navigating to different sections within a buffer.  To try `imenu` with
Markdown Mode, simply run `M-x imenu-add-menubar-index`.  An "Index"
menu will appear in the menubar.  Clicking a heading moves the point
to that heading.  Alternatively, when invoking `M-x imenu` using the
keyboard Emacs will present you with a list of headings in the
minibuffer.

{width=70%}
![`imenu` Index Menu](images/imenu-index.png)

Markdown Mode adds a single period (`.`) to the top of each sub-menu.
Clicking it takes you to the parent section.  Otherwise, there is no
way to jump directly to headings that are not leaf nodes in the
heading tree.

To automatically load `imenu` when `markdown-mode` is loaded, you can
add the following to your `.emacs` or `init.el` file:

``` emacs-lisp
(add-hook 'markdown-mode-hook 'imenu-add-menubar-index)
(setq imenu-auto-rescan t)
```

The first line asks Emacs to run the `imenu-add-menubar-index`
function each time `markdown-mode` is loaded.  The second line asks
`imenu` to keep the index up to date when files are modified, as
sections are added or removed.

By default, the `imenu` menu is nested.  If you prefer a flat menu,
you can customize `markdown-nested-imenu-heading-index`.

`markdown-nested-imenu-header-index`

:   Boolean, default: `t`.

    Use nested `imenu` heading index when non-`nil` and a flat menu
    otherwise.  A nested index may provide more natural browsing from
    the menu bar, but a flat list may allow for faster keyboard
    navigation via tab completion.

`markdown-add-footnotes-to-imenu`

:   Boolean, default: `t`.

    Add a list of footnotes to the end of the imenu index.
    The entries will be footnote markers (e.g., "^1") and
    clicking an entry will take you to the footnote definition.

Another useful `imenu`-based package is [`imenu-list`](https://github.com/bmag/imenu-list), a
third-party package which shows the current buffer's `imenu` entries
in a pop-up buffer.  You can install `imenu-list` from MELPA.
With [use-package](https://github.com/jwiegley/use-package), you can configure it like so:

``` emacs-lisp
(use-package imenu-list
  :ensure t
  :bind (("C-'" . imenu-list-smart-toggle))
  :config
  (setq imenu-list-focus-after-activation t
        imenu-list-auto-resize nil))
```

This binds `C-'` (`imenu-list-smart-toggle`) so that when pressing it
a window appears on the right side showing the heading hierarchy in
the `*Ilist*` buffer.  Pressing `C-'` again hides the window.

{width=80%}
![Markdown Mode with `imenu-list`](images/imenu-list.png)

By default, the point stays in the original window and so the
`*Ilist*` window is not focused.  Setting the variable
`imenu-list-focus-after-activation` to a non-`nil` value, as above,
changes the focus to the new window so that you can immediately issue
commands there.

The `*Ilist*` buffer is periodically refreshed.  If you want the width
of the window containing it to adjust automatically each time it is
refreshed, then set the variable `imenu-list-auto-resize` to `t`
instead.

There are several keybindings in the `*Ilist*` buffer for
navigating between sections:

* `RET` or mouse click - visit heading at point
* `SPC` - visit heading, but keep focus on `*Ilist*` buffer
* `TAB` or `f` - fold/unfold subtree
* `n` and `p` - next/previous line
* `g` - refresh entries
* `q` - quit window and disable `imenu-list-minor-mode`

Unlike the `imenu` Index menu, the `*Ilist*` buffer is updated
automatically.


## File Local Variables {#file-local}

Emacs allows one to specify values for
[variables inside files themselves](https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Variables.html).
For example, you can specify which mode Emacs should use to edit a
particular file by setting a special variable named `mode`.  You can
specify such file local variables at either the beginning or end of a
file.

Perhaps you have seen lines like the following at the beginning of
scripts.  This particular line tells Emacs that you would like to open
this file using `cperl-mode`:

``` perl
#!/usr/bin/perl       -*- mode: cperl -*-
```

The `mode` variable is special; it is not an actual variable name in
Emacs.  Another special variable is `coding`, which specifies the
character coding system for this file (e.g., `utf-8` or `latin-1`).  A
third special variable is `eval`, which specifies a Lisp expression to
evaluate.  Multiple `eval` declarations can be given in the same file.

Among the special variables, `mode` is the most special of all and so
the `mode:` declaration can even be omitted:

``` perl
#!/usr/bin/perl       -*-cperl-*-
```

File variable definitions should appear in a comment and the comment
syntax used by Markdown Mode is the same as for HTML comments: `<!--
comment -->`.  So, to specify a local variable at the beginning of a
file you could add the following to the first line (which would result
in Emacs loading the file in `gfm-mode` instead of, say,
`markdown-mode`):

``` html
<!-- -*- mode: gfm -*- -->
```

To specify multiple variables, separate them by semicolons:

``` html
<!-- -*- mode: markdown; coding: utf-8 -*- -->
```

Alternatively, you can insert a local variable block at the _end_ of a
file.  Such a block opens with a `Local Variables:` declaration and
closes with `End:`, like so:

``` html
<!-- Local Variables: -->
<!-- markdown-enable-math: t -->
<!-- End: -->
```

It is not necessary that each line is a self-contained comment, so the
following also works and it is a personal preference which form you
use:

``` html
<!--
Local Variables:
markdown-enable-math: t
End:
-->
```

One useful scenario for using file local variables with Markdown files
include toggling special modes, like setting `markdown-enable-math` in
the previous example.  If you mostly leave math mode disabled (so that
`$` is not a special character), but sometimes want to enable it,
using a file-local variable as above is a great way to handle this
case.

Other example uses are setting the `fill-column` in a particular file,
or declaring that spaces should be used for indentation instead of
tabs:

``` html
<!--
Local Variables:
fill-column: 70
indent-tabs-mode: nil
End:
-->
```

## Generating a Table of Contents

A package called [`markdown-toc`](https://github.com/ardumont/markdown-toc)
allows users to generate and update a table of contents in Markdown
files.  Like Markdown Mode itself, you can install it from [MELPA](https://melpa.org/#/markdown-toc)
or [MELPA Stable](https://stable.melpa.org/#/markdown-toc): `M-x package-install RET markdown-toc`.

To insert the table of contents initially, place the point where you
would like it to appear and issue `M-x markdown-toc-generate-toc`.
You will see a header comment, a title, a Markdown-formatted nested
list of headings, and a footer comment, as in the following example:

{lang=text}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<!-- markdown-toc start - Don't edit this section. 
     Run M-x markdown-toc-generate-toc again -->
**Table of Contents**

- [Introduction](#introduction)
    - [Quick Reference](#quick-reference)
    - [Markdown](#markdown)
        - [Markdown Syntax Reference](#markdown-syntax-reference)
        - [Additional Information](#additional-information)
    ...

<!-- markdown-toc end -->
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

After it has been inserted, you can update the table of contents with
`M-x markdown-toc-refresh-toc`.  As an alternative, you can use the combined
generate-or-refresh command `M-x markdown-toc-generate-or-refresh-toc`.
Finally, to remove it run `M-x markdown-toc-delete-toc`.

W> Notice that `markdown-toc` generates anchors (e.g., `#quick-reference`)
W> automatically.  You will need to make sure that your Markdown processor
W> of choice also generates these in the resulting HTML and that it
W> follows the same format (i.e., replacing spaces with hyphens).  This is
W> the format used by MultiMarkdown, for example.

You can also customize the title and the start and end comments:

``` emacs-lisp
(custom-set-variables
 '(markdown-toc-header-toc-start "<!-- customized start-->")
 '(markdown-toc-header-toc-title "**customized title**")
 '(markdown-toc-header-toc-end "<!-- customized end -->"))
```

## Highlighting and Preserving Whitespace

Whitespace is an important part of Markdown.  For example, two spaces
at the end of a line produce a hard line break and blocks indented by
four spaces become code blocks.

If you want to temporarily display whitespace in a file, you can
enable `whitespace-mode`, which is part of Emacs, by typing `M-x
whitespace-mode`.  Issue the command again to disable it.

On a related note, if you use `whitespace-cleanup-mode` to tidy up
your files automatically, then you may want to disable it in
`markdown-mode`.  To do so, you can add the following to your init
file:

``` emacs-lisp
(after-load 'whitespace-cleanup-mode
            (push 'markdown-mode whitespace-cleanup-mode-ignore-modes))
```


## Using Flyspell with Markdown Mode

Flyspell Mode enables on-the-fly spell checking in Emacs.  If you want
to always enable `flyspell-mode` when Markdown Mode is loaded, you can add
the following to your init file:

``` emacs-lisp
(add-hook 'markdown-mode-hook 'flyspell-mode)
```

Starting with version 2.3, Markdown Mode defines a
`flyspell-generic-check-word-predicate` function which lets Flyspell
know that it should ignore code blocks, inline code, and comments,
reference labels, Markdown markup, and URLs.


## Keeping Notes in a Local Wiki

![Local Wiki Files in Markdown Mode](images/local-wiki.png)

Markdown Mode supports wiki links, so you can use it keep notes in a
local wiki.  You can create `[[wiki links]]` to other files and open
them by moving the point to the link and pressing `C-c C-o`.  If a
file doesn't exist, it will be created.  You can move quickly between
links with `M-n` (`markdown-next-link`) and `M-p`
(`markdown-previous-link`).

As discussed in the section on [Wiki Links](#wiki-links), there are several
settings you may want to customize.  When following wiki links,
Markdown Mode looks for a file with the same extension as the current
one.  The variable `markdown-link-space-sub-char` determines how
spaces are handled when transforming the link text to a file name.
Finally, if you want to highlight missing links as in the screenshot
above, set `markdown-wiki-link-fontify-missing` to `t`.


## Integration with Deft Mode

{width=80%}
![Deft Mode with Notes in Markdown Format](images/deft.png)

[Deft](https://jblevins.org/projects/deft/) is an Emacs mode for quickly browsing, filtering, and
editing directories of plain text notes, inspired by Notational
Velocity.  It was designed for increased productivity when writing and
taking notes by making it fast and simple to find the right file at
the right time and by automating many of the usual tasks such as
creating new files and saving files.

If you keep notes in Markdown format (perhaps in wiki form, as in the
previous section), then you might also enjoy Deft.  You don't
have to use Markdown---Deft works with LaTeX files, Org files,
etc.---but it has some Markdown-specific features.  For example, it
automatically strips Markdown heading markup when displaying note
titles.  It also allows you to customize the Markdown heading level of
new notes.

Below is a simplified version of my own Deft configuration, which I
mostly use with Markdown files.  This binds Deft to `<f8>`, enables
recursive subdirectory search for notes, configures several file
extensions I use for notes, and customizes some of the file naming and
titling options.

``` emacs-lisp
(use-package deft
  :bind (("<f8>" . deft))
  :commands (deft deft-open-file deft-new-file-named)
  :config
  (setq deft-directory "~/notes/"
        deft-recursive t
        deft-extensions '("md" "txt" "org" "tex")
        deft-use-filter-string-for-filename nil
        deft-use-filename-as-title nil
        deft-markdown-mode-title-level 1
        deft-file-naming-rules '((noslash . "-")
                                 (nospace . "-")
                                 (case-fn . downcase)))
```


## MathJax Integration

{width=80%}
![Markdown with Math Mode and MathJax Preview](images/mathjax.png)

If you want to include mathematical expressions in LaTeX form in your
Markdown files, Markdown Mode assists you with [Math Mode](#math) for
editing (see the [Extensions](#extensions) chapter for details).  For viewing or
publishing, you will need some way to view the LaTeX in a readable form.
One option is to use [MathJax](https://www.mathjax.org), a cross-browser JavaScript package
for rendering mathematics in LaTeX and MathML form.

Even if you don't use MathJax in your publication workflow, it can be
useful for previewing Markdown files containing mathematics.  To do
this, you can ask Markdown Mode to add the necessary JavaScript tags
to the `<head>` block of your HTML preview output using the
`markdown-xhtml-header-content` variable:

``` emacs-lisp
(setq markdown-xhtml-header-content
      (concat "<script type=\"text/javascript\" async"
              " src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/"
              "2.7.1/MathJax.js?config=TeX-MML-AM_CHTML\">"
              "</script>"))
```

W> The `TeX-MML-AM_CHTML` configuration in the example above very
W> general, and therefore larger than other configurations.  It is
W> useful as a default to get started, but you will most likely want to
W> use a more appropriate, specific configuration for production use,
W> for better performance.

W> You will need to make sure that your Markdown processor is generating
W> HTML fragments, rather than standalone documents, so that Markdown
W> Mode can add a header and footer with your custom `<script>` tag.


## Using Pre- and Post-Processors

A Unix "pipeline" is a sequence of processes connected through
_pipes_.  The standard output of each process is directed to the
standard input of the following one.

X> To give a generic example of pipes, the following command lists all
X> running processes, filters out those without `markdown` in the name,
X> removes the `grep markdown` process itself, extracts the process IDs
X> using `awk`:
X>
X>     ps aux | grep markdown | grep -v grep | awk '{print $2}'

With Markdown Mode, the Markdown processor given by the variable
`markdown-command` can be a pipeline, and so it can be used to apply
pre- or post-processors to your Markdown files.

As an example, one common Markdown post-processor is [SmartyPants](http://daringfireball.net/projects/smartypants/),
which implements "smart typography" (curly quotation marks, en-dashes,
em-dashes, and so on).  To use it, you will need to first install
SmartyPants.

*   On Debian Linux, you can install `libtext-typography-perl`.
*   On macOS with Homebrew, you can use `brew install smartypants`.
*   Otherwise, you can install it manually by downloading the
    [SmartyPants zip file](http://daringfireball.net/projects/smartypants/), uncompressing it, and placing
    `SmartyPants.pl` in your `PATH`.

Once you have SmartyPants installed, note the path of the script.  For
example, suppose it is installed in your Emacs `exec-path` path as
`smartypants`.  Then to use SmartyPants when previewing and exporting
from Markdown Mode, you would set `markdown-command` so that the
`markdown` output is piped to `smartypants`.  You can do this either
by using `M-x customize-group RET markdown` or by placing the
following in your init file:

``` emacs-lisp
(setq markdown-command "markdown | smartypants")
```


## Using a Custom Web Browser

To open a browser, Markdown Mode calls the function specified in
`browse-url-browser-function`.  To determine what value is currently
used in your own Emacs, you can use `M-x describe-variable RET
browse-url-browser-function`.  To use a different browser, customize the
variable with `M-x customize-option RET browse-url-browser-function`
and answer the questions presented.

{width=80%}
![Customizing `browse-url-browser-function`](images/browse-url-browser-function.png)

If you want to change the setting in your init file instead, you can
simply add something like the following:

``` emacs-lisp
(setq browse-url-browser-function #'browse-url-chrome)
```

For reference, here is a selection of the available `browse-url`
functions in Emacs 25.2:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
browse-url-chrome                   browse-url-epiphany
browse-url-chromium                 browse-url-firefox
browse-url-conkeror                 browse-url-galeon
browse-url-default-browser          browse-url-generic
browse-url-default-macosx-browser   browse-url-gnome-moz
browse-url-default-windows-browser  browse-url-kde
browse-url-elinks                   browse-url-mozilla
browse-url-elinks-new-window        browse-url-w3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If your browser is not supported, choose `browse-url-generic` and set
`browse-url-generic-program` to the path of your browser's executable.
The downside of using a generic browser is that you lose "remote
control" and as a result, a new process will be spawned for every URL
you open.

The above options change the browser for Emacs _globally_.  On the
other hand, if for some reason you only wanted to change the browser
used for Markdown Mode previewing specifically, you can achieve this
by "advising" the `markdown-preview` function:

``` emacs-lisp
(advice-add 'markdown-preview :around
            (lambda (orig &rest args)
              "Use Chromium as default browser."
              (let ((browse-url-browser-function #'browse-url-chromium))
                (apply orig args))))
```

This example changes the browse function to `browse-url-chromium` for
the `markdown-preview` function only.  See the section on
[Advising Emacs Lisp Functions](https://www.gnu.org/software/emacs/manual/html_node/elisp/Advising-Functions.html) in the Emacs Lisp Reference
Manual for additional details.


## Using Marked 2 as a Standalone Previewer

{width=60%}
![Marked 2 Preview of this Book](images/marked-2.png)

You can customize the program used to "open" Markdown files from
Markdown Mode via `C-c C-c o`.  The variable you will want to customize
is `markdown-open-command`.

On macOS, a popular application for opening Markdown files is
[Marked 2](https://geo.itunes.apple.com/us/app/marked-2/id890031187?mt=12&at=11l5Vs), a live-updating Markdown previewer.  Perhaps the
easiest way to configure Markdown Mode to use it is to write a simple
shell script to serve as a wrapper to open Marked 2 from the command
line.[^m2]

Below is an example script named `mark`.  Be sure to place it
somewhere in your path (e.g., `/usr/local/bin`) and use `chmod +x` to
make it executable.

<<[Shell Script to Use Marked 2 as a Previewer](code/mark)

Then you can ask Markdown Mode to call the script for opening the
current file by setting `markdown-open-command`:

``` emacs-lisp
(setq markdown-open-command "/usr/local/bin/mark")
```

Furthermore, once you install the `mark` script you can simply type
`mark <filename>` in a terminal to open a Markdown file.

[^m2]: See <https://jblevins.org/log/marked-2-command> for details.

## Pandoc Mode

Pandoc, in addition to being a Markdown-to-HTML processor, can convert
multiple input formats to each of several output formats.  For
example, it can also convert Markdown to LaTeX or Org format.

[Pandoc Mode](https://joostkremers.github.io/pandoc-mode/) is an Emacs interface for Pandoc, implemented as a
minor mode.  You can install it from [MELPA](https://melpa.org/#/pandoc-mode) or [MELPA Stable](https://stable.melpa.org/#/pandoc-mode) and
activate it by typing `M-x pandoc-mode`.  The documentation summarizes
Pandoc Mode as follows:

> `pandoc-mode` uses the `hydra` package to create a keyboard-driven
> menu interface to all options and settings.  Pressing `C-c /` calls
> the main menu.  After that, everything should be self-explanatory.
> From the main menu, you can run `pandoc` on the buffer, view the
> output buffer and the current settings, set the input and output
> formats, and you can go to the options menu.

Some examples of settings Pandoc Mode can manage for you are:

*   produce standalone output or a snippet,
*   use a template file,
*   generate a table of contents,
*   include a header or footer,
*   set the syntax highlighting style,
*   render mathematical equations,
*   link to a CSS stylesheet.

These are but a few of the available options.  Pandoc Mode also adds
font lock support for Pandoc citations and numbered example lists.

With Pandoc Mode you can create multiple output profiles for a single
input file.  You might have a Markdown file that you want to convert
to HTML for publishing on your website and to PDF for printing.

You can change the output settings from the `pandoc-mode` menus, or
you can store them in settings files on a per-project or global
basis.  If your main file name is `article.md` then the settings file
for HTML output would be `.article.md.html.pandoc`.

If you use Pandoc Mode often, you can add a hook to load it
automatically with Markdown Mode whenever a `pandoc-mode` settings
file is detected:

``` emacs-lisp
(add-hook 'markdown-mode-hook 'conditionally-turn-on-pandoc)
```

## R Markdown

[R Markdown](http://rmarkdown.rstudio.com) is a Markdown dialect created by RStudio specifically
for producing reports from the R statistical package.  For example, it
supports evaluation of R code blocks, with the output of the code
included in the document.  R Markdown supports a variety of output
formats, including HTML, PDF, and Word.

R Markdown files have the `.Rmd` extension, so at the very least
you will want to use `markdown-mode` for those files.  For example:

``` emacs-lisp
(add-to-list 'auto-mode-alist '("\\.Rmd\\'" . markdown-mode))
```

The basic Markdown syntax is unchanged in R Markdown, but it supports
several extensions.  Fenced code blocks with braces around the
language name are used to format R code blocks:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```{r}
summary(cars$dist)
summary(cars$speed)
```
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You can also provide options in the code block info string:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```{r, eval=FALSE}
summary(cars)
```
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Markdown Mode will use `r-mode` for syntax highlighting in these code
blocks if you enable native font lock.  To do so, use
`markdown-toggle-fontify-code-blocks-natively` or `C-c C-x C-f`.

## Tracking Changes with CriticMarkup Mode

{width=80%}
![CriticMarkup Mode and Markdown Mode](images/cm-mode.png)

[CriticMarkup](http://criticmarkup.com) is a plain text markup language for tracking
changes to Markdown and other compatible documents.  It defines the
following tags for marking changes:

*   Addition: `{++added++}`
*   Deletion: `{--removed--}`
*   Substitution: `{~~old~>new~~}`
*   Comment: `{>>comment<<}`
*   Highlight: `{==highlight==}{>>comment<<}`

[`cm-mode`](https://github.com/joostkremers/criticmarkup-emacs)
is a minor mode that provides support for CriticMarkup
in Emacs.  Like other packages described, it is available on [MELPA](https://melpa.org/#/cm-mode)
and [MELPA Stable](https://stable.melpa.org/#/cm-mode).  First, it provides font-lock support for the
markup tags above, and it defines the customizable faces used to
highlight them.  To customize the faces, see the `criticmarkup-faces`
group.  Second, it provides keybindings for insert CriticMarkup tags
to track changes in a file:

*   `C-c * a` - add text
*   `C-c * d` - delete text
*   `C-c * s` - substitute text
*   `C-c * c` - insert a comment (possibly with highlight)

`cm-mode` uses `C-c *` as a prefix, but this can easily be
changed to, say, `C-c c` like so:

``` emacs-lisp
(define-key cm-mode-map (kbd "C-c *") nil)
(define-key cm-mode-map (kbd "C-c c") cm-prefix-map)
```


## Editing HTML as Markdown

![HTML Mode and HTML as Markdown Mode](images/ham-mode.png)

[HTML as Markdown Mode](https://github.com/Malabarba/ham-mode), or `ham-mode`, allows you to edit
HTML files as if they were Markdown files.  That is, it provides a
transparent layer so that you can edit an HTML file using Markdown Mode.
It first converts the HTML to Markdown but any updates to the contents
are converted back to HTML.

To install the package from [MELPA](https://melpa.org/#/ham-mode) or [MELPA Stable](https://stable.melpa.org/#/ham-mode), simply
run `M-x package-install RET ham-mode`.  To activate it while visiting
an HTML file, run `M-x ham-mode`.

## Adding Custom Font Lock Keywords

Suppose there are certain phrases or patterns that you'd like to
highlight in Markdown files.  Examples might include fixed words, such
as "FIXME" and "TODO", or a pattern such as tags of the form "@closed"
or "@new".  Emacs allows you to add custom font lock keywords to
handle such cases by calling `font-lock-add-keywords`, as in the
following examples.

As a first simple example, to highlight "FIXME:" using
`font-lock-warning-face` when editing files in `markdown-mode` , you
can add the following to your init file:

``` emacs-lisp
(font-lock-add-keywords
 'markdown-mode
 '(("\\<\\(FIXME\\):" 1 font-lock-warning-face t)))
```

Here we specify `markdown-mode` for the mode argument and then we give
a list of "keywords".  In this case there is only one keyword which
consists of a regular expression, a group number, and a face.

As a second example, to highlight words beginning with "@", such as
"@closed", using `font-lock-variable-name-face` when in
`markdown-mode`, you could use the following:

``` emacs-lisp
(font-lock-add-keywords
 'markdown-mode
 '(("\\W@\\w+" . font-lock-variable-name-face)))
```

See the section on [Search-based Fontification](https://www.gnu.org/software/emacs/manual/html_node/elisp/Search_002dbased-Fontification.html#Search_002dbased-Fontification) in the Emacs Lisp
Reference Manual for details on the possible keyword forms.

------------------------------------------------------------------------------

# Markdown Mode Development {#devel}

Markdown Mode is an open source project.  The primary repository for
Markdown Mode is [on GitHub](https://github.com/jrblevin/markdown-mode).  Anyone can easily browse the
project files by visiting the project's GitHub page
at <https://github.com/jrblevin/markdown-mode>.

If you would like to contribute to Markdown Mode development, the best
way to start is to clone the Git repository.  You can clone the
repository using the HTTPS, SSH, and Git protocols:

{lang="text"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
git clone https://github.com/jrblevin/markdown-mode.git
git clone git://github.com/jrblevin/markdown-mode.git
git clone ssh://git@github.com:jrblevin/markdown-mode.git
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

## Testing the Development Version

To test the current development version, you may either download
`markdown-mode.el` from the [GitHub repository](https://github.com/jrblevin/markdown-mode) or install the
`markdown-mode` package from [MELPA](https://melpa.org/#/markdown-mode).

Note that by nature, the development version of Markdown Mode may be
unstable or even unusable at times.  It is not recommend for daily
use unless you are fine with things occasionally breaking.  Function
names, features, keybindings, etc. may change without notice.

Supposing you have stored `markdown-mode.el` in directory named
`/path/to/markdown-mode`, then you will probably need to make sure that
Emacs can find it by adding something like the following to your init
file:

``` emacs-lisp
(add-to-list 'load-path "/path/to/markdown-mode")
```

Alternatively, you can install the `markdown-mode` package from the
(unstable) [MELPA repository](https://melpa.org/#/markdown-mode).  In
this case, you might need to tell the package manager about the
repository in your init file, like so:

``` emacs-lisp
(require 'package)
(add-to-list 'package-archives
             '("melpa" . "http://melpa.org/packages/"))
(package-initialize)
```


## Reporting Bugs and Issues

Markdown Mode is developed and tested primarily for compatibility with
GNU Emacs 24.4 and later.  If you are using an older version of Emacs,
please update to a more recent version first to see if the issue
persists.

If you do find a bug in Markdown Mode, please construct a test
case---and if possible a patch---and open a ticket on the
[GitHub issue tracker](https://github.com/jrblevin/markdown-mode/issues)
at <https://github.com/jrblevin/markdown-mode/issues>.  Before
reporting an issue, please try to reproduce the issue with a minimal
Emacs configuration, for example, by starting Emacs without your usual
local init file (e.g., starting with `emacs --no-init`) and then
loading `markdown-mode` with `M-x load-file`.


## Submitting Patches or GitHub Pull Requests

Below are some guidelines for submitting patches.  Ideally, these
should be submitted in the form of GitHub pull requests, but email
patches are also fine if that is more convenient.  For pull requests,
it is recommended to create a new feature branch (e.g.,
`feat/my-new-feature`) and submit the pull request from that branch.
(If you instead add commits to the `master` branch in your own
repository, it's more difficult to get back in sync if changes are
required to the patch.)

*   Markdown mode contributions should adhere to both the
    [GNU Emacs Lisp coding conventions](https://www.gnu.org/software/emacs/manual/html_node/elisp/Coding-Conventions.html) and the
    [Major Mode Conventions](https://www.gnu.org/software/emacs/manual/html_node/elisp/Major-Mode-Conventions.html#Major-Mode-Conventions).

*   Test cases are needed for significant changes.  Markdown Mode uses
    the `ert` (Emacs Lisp Regression Testing) library.  If you are not
    familiar with writing tests, there are hundreds of examples in
    `markdown-test.el` that you can use as a starting point for new
    tests.

*   You can confirm that your tests pass by either typing `make test`
    from the command line or by issuing a GitHub pull request and
    letting the [Travis CI](https://travis-ci.org/jrblevin/markdown-mode) integration on GitHub run the tests for you.

*   Please be sure to update the documentation at the top of
    `markdown-mode.el` and the docstrings for related variables or
    functions.

*   If your patch involves changes to the documentation, you can
    update the `README.md` file by running the `webpage.sh` script.

*   Finally, it's also helpful if you update the `CHANGES.md` file to
    reflect the bug you fixed or the feature you added or improved.

------------------------------------------------------------------------------

# Conclusion

## Looking Back and Looking Ahead

When I wrote the first version of `markdown-mode.el` over ten years
ago, I never imagined it would reach as many people as it has.  This
was before GitHub was founded and around the same time `package.el`
was initially being developed.  Emacs 21.4 was the latest release and
Markdown itself was three years old.

Markdown Mode development continues and my goals for upcoming releases
are to improve performance, streamline the code base, build a more
robust Markdown parsing engine, and make it easier for users to choose
feature sets to match their preferred Markdown dialects.

Many parts of Emacs are designed around a dichotomous view of files as
either source code for a programming language or free form text.
Markdown lies somewhere in between these two extremes, and sometimes
the best route for implementing new features in Emacs is not obvious.
As Markdown Mode and my own understanding of the subtleties of Emacs
Lisp grow, I hope that Markdown integration in Emacs can become
even faster, more seamless, and more robust.

## Further Reading

To keep up with Markdown Mode news, you can follow my blog at
<https://jblevins.org/log/> or follow the project on GitHub at
<https://github.com/jrblevin/markdown-mode/>.  For Emacs news more
generally, there is [Planet Emacsen](http://planet.emacsen.org), a feed aggregator at
<http://planet.emacsen.org/>, and [Sacha Chua's weekly Emacs News](http://sachachua.com/blog/)
at <http://sachachua.com/blog/>.

I also highly recommend [_Mastering Emacs_](https://masteringemacs.org/) by Mickey Petersen for
all Emacs users.  Few could read this book and not learn _something_
new about our favorite text editor. _Mastering Emacs_ was a primary
source of inspiration for me in writing this _Guide_.  It is available
at <https://masteringemacs.org/>.

There are also active Emacs communities on the [EmacsWiki](https://www.emacswiki.org/) at
<https://www.emacswiki.org/>, the [Emacs StackExchange](https://emacs.stackexchange.com) at
<https://emacs.stackexchange.com>, and on [Reddit](https://www.reddit.com/r/emacs/) at
<https://www.reddit.com/r/emacs/>.

Finally, every Emacs user should practice getting help from within
Emacs itself, which is often the most detailed and up to date source
and certainly the most convenient.  A few of the most useful commands
are `C-h k` (`describe-key`), `C-h m` (`describe-mode`), `C-h f`
(`describe-function`), and `C-h v` (`describe-variable`), and `C-h a`
(`apropos-command`).

<!--
Local Variables:
mode: markdown
coding: utf-8
markdown-hide-urls: t
End:
-->
